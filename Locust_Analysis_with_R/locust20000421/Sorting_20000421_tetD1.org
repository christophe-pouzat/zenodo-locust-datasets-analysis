# -*- ispell-local-dictionary: "american" -*-
#+OPTIONS: ':nil *:t -:t ::t <:t H:3 \n:nil ^:nil arch:headline
#+OPTIONS: author:t broken-links:nil c:nil creator:nil
#+OPTIONS: d:(not "LOGBOOK") date:t e:t email:nil f:t inline:t num:t
#+OPTIONS: p:nil pri:nil prop:nil stat:t tags:t tasks:t tex:t
#+OPTIONS: timestamp:t title:t toc:t todo:t |:t
#+TITLE: Sorting data set 20000421 tetrode D1 (channels 9, 10, 11, 12)
#+AUTHOR: Christophe Pouzat
#+EMAIL: christophe.pouzat@parisdescartes.fr
#+LANGUAGE: en
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
#+CREATOR: Emacs 25.1.1 (Org mode 9.0)
#+LaTeX_CLASS: koma-article
#+LaTeX_CLASS_OPTIONS: [koma,11pt]
#+LaTeX_HEADER: \usepackage{cmbright}
#+LaTeX_HEADER: \usepackage[round]{natbib}
#+LaTeX_HEADER: \usepackage{alltt}
#+LaTeX_HEADER: \usepackage[usenames,dvipsnames]{xcolor}
#+LaTeX_HEADER: \renewenvironment{verbatim}{\begin{alltt} \scriptsize \color{Bittersweet} \vspace{0.2cm} }{\vspace{0.2cm} \end{alltt} \normalsize \color{black}}
#+LaTeX_HEADER: \usepackage{listings}
#+LaTeX_HEADER: \lstloadlanguages{C,Gnuplot,bash,sh,R}
#+LaTeX_HEADER: \hypersetup{colorlinks=true,pagebackref=true}
#+PROPERTY: header-args:R :session *R*
#+PROPERTY: header-args:R :eval never-export
#+PROPERTY: header-args:R :output-dir locust20000421_tetD1_fig
#+LINK_HOME: ../../index.html
#+LINK_UP: ../../index.html
  
#+NAME: org-latex-set-up
#+BEGIN_SRC emacs-lisp :exports none :results silent 
(setq smartparens-mode nil)
(require 'ox-latex)
(setq org-export-latex-listings t)
(setq org-latex-listings 'listings)
(setq org-latex-listings-options
        '(("frame" "lines")
          ("basicstyle" "\\footnotesize")
          ("numbers" "left")
          ("numberstyle" "\\tiny")))
(add-to-list 'org-latex-classes
          '("koma-article"
             "\\documentclass{scrartcl}"
             ("\\section{%s}" . "\\section*{%s}")
             ("\\subsection{%s}" . "\\subsection*{%s}")
             ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
             ("\\paragraph{%s}" . "\\paragraph*{%s}")
             ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
(setq org-latex-pdf-process
      '("pdflatex -interaction nonstopmode -output-directory %o %f"
	"bibtex %b" 
	"pdflatex -interaction nonstopmode -output-directory %o %f" 
	"pdflatex -interaction nonstopmode -output-directory %o %f"))
#+END_SRC

* Introduction

This is the description of how to do the (spike) sorting of tetrode D1 (channels 9, 10, 11, 12) from data set =locust20000421=.

** Getting the data

The data are in file =locust20000421.hdf5= located on [[https://zenodo.org/record/21589][zenodo]] and can be downloaded interactivelly with a web browser or by typing at the command line:

#+NAME: wget-locust20000421
#+BEGIN_SRC sh :eval never
wget https://zenodo.org/record/21589/files/locust20000421.hdf5
#+END_SRC

In the sequel I will assume that =R= has been started in the directory where the data were downloaded (in other words, the working direcory should be the one containing the data.

The data are in [[https://support.hdfgroup.org/HDF5/][HDF5]] format and the easiest way to get them into =R= is to install the =rhdf5= package from [[http://www.bioconductor.org/packages/release/bioc/html/rhdf5.html][Bioconductor]]. Once the installation is done, the library is loaded into =R= with:

#+NAME: load-rhdf5
#+BEGIN_SRC R :session *R*
library(rhdf5)
#+END_SRC

#+RESULTS: load-rhdf5
| rhdf5     |
| stats     |
| graphics  |
| grDevices |
| utils     |
| datasets  |
| methods   |
| base      |

We can then get a (long and detailed) listing of our data file content with (result not shown):

#+NAME: locust20000421.hdf5-h5ls
#+BEGIN_SRC R :eval never
h5ls("locust20000421.hdf5")
#+END_SRC

We can get the content of =LabBook= =metadata= /from the shell/ with:

#+NAME: locust20000421_part1.hdf5-h5dump
#+BEGIN_SRC shell :results output :exports both :eval never
h5dump -a "LabBook" locust20000421.hdf5
#+END_SRC

** Getting the code

The code can be sourced as follows:

#+NAME: get-code-4-sorting
#+BEGIN_SRC R :session *R* :results silent
source("https://raw.githubusercontent.com/christophe-pouzat/zenodo-locust-datasets-analysis/master/R_Sorting_Code/sorting_with_r.R")
#+END_SRC

* Tetrode D1 (channels 9, 10, 11, 12) analysis

We now want to get our "model", that is a dictionnary of waveforms (one waveform per neuron and per recording site). To that end we are going to use the first 60 s of data contained in the =Spontaneous= =Group= (in =HDF5= jargon). 

** Loading the data

So we start by loading the data from channels 9, 10, 11, 12 into =R=:

#+NAME: load-tetD1-spontaneous-into-lD
#+BEGIN_SRC R :exports both :session *R*
lD = rbind(cbind(h5read("locust20000421.hdf5", "/Spontaneous/ch9"),
                 h5read("locust20000421.hdf5", "/Spontaneous/ch10"),
                 h5read("locust20000421.hdf5", "/Spontaneous/ch11"),
                 h5read("locust20000421.hdf5", "/Spontaneous/ch12")))
dim(lD)
#+END_SRC

#+RESULTS: load-tetD1-spontaneous-into-lD
| 892928 |
|      4 |


** Five number summary

We get the [[https://en.wikipedia.org/wiki/Five-number_summary][Five number summary]] with:

#+NAME: lD-FNS-tetD1
#+BEGIN_SRC R :exports both :session *R*
summary(lD,digits=2)
#+END_SRC

#+RESULTS: lD-FNS-tetD1
| Min.   : 746 | Min.   :1653 | Min.   :1497 | Min.   :1398 |
| 1st Qu.:2005 | 1st Qu.:1992 | 1st Qu.:2013 | 1st Qu.:2011 |
| Median :2048 | Median :2033 | Median :2055 | Median :2054 |
| Mean   :2047 | Mean   :2033 | Mean   :2054 | Mean   :2053 |
| 3rd Qu.:2092 | 3rd Qu.:2074 | 3rd Qu.:2095 | 3rd Qu.:2095 |
| Max.   :2996 | Max.   :2423 | Max.   :2524 | Max.   :2581 |


It shows that the channels have very similar properties as far as the median and the inter-quartile range (IQR) are concerned. The minimum is much smaller on the first channel. This suggests that the largest spikes are going to be found here (remember that spikes are going mainly downwards).

** Plot the data

We "convert" the data matrix =lD= into a =time series= object with:

#+NAME: lD-to-ts-tetD1
#+BEGIN_SRC R :session *R* :results silent
lD = ts(lD,start=0,freq=15e3)
#+END_SRC

We can then plot the whole data with (not shown since it makes a very figure):

#+NAME: plot-lD-tetD1
#+BEGIN_SRC R :eval never
plot(lD)
#+END_SRC

** Data normalization

As always we normalize such that the [[https://en.wikipedia.org/wiki/Median_absolute_deviation][median absolute deviation]] (MAD) becomes 1:

#+NAME: lD-normalization-tetD1
#+BEGIN_SRC R :session *R* :results silent
lD.mad = apply(lD,2,mad)
lD = t((t(lD)-apply(lD,2,median))/lD.mad)
lD = ts(lD,start=0,freq=15e3)
#+END_SRC

Once this is done we explore interactively the data with:

#+NAME: lD-explore-tetD1
#+BEGIN_SRC R :eval never
explore(lD,col=c("black","grey70"))
#+END_SRC

Most spikes can be seen on the 4 recording sites and there are different spike waveform!

** Spike detection

Since the spikes are mainly going downwards, we will detect valleys instead of peaks:

#+NAME: lD-detect-spikes-tetD1
#+BEGIN_SRC R :exports both :session *R* :results output
lDf = -lD
filter_length = 3
threshold_factor = 4.5
lDf = filter(lDf,rep(1,filter_length)/filter_length)
lDf[is.na(lDf)] = 0
lDf.mad = apply(lDf,2,mad)
lDf_mad_original = lDf.mad
lDf = t(t(lDf)/lDf_mad_original)
thrs = threshold_factor*c(1,1,1,1)
bellow.thrs = t(t(lDf) < thrs)
lDfr = lDf
lDfr[bellow.thrs] = 0
remove(lDf)
sp0 = peaks(apply(lDfr,1,sum),15)
remove(lDfr)
sp0
#+END_SRC

#+RESULTS: lD-detect-spikes-tetD1
: 
: eventsPos object with indexes of 1184 events. 
:   Mean inter event interval: 754.31 sampling points, corresponding SD: 861.44 sampling points 
:   Smallest and largest inter event intervals: 17 and 9283 sampling points.



Every time a filter length / threshold combination is tried, the detection is checked interactively with:

#+NAME: lD-sp0-check-tetD1
#+BEGIN_SRC R :eval never
explore(sp0,lD,col=c("black","grey50"))
#+END_SRC

** Cuts

We proceed as usual to get the cut length right:

#+NAME: cut-length-plot-tetD1
#+HEADER: :width 800 :height 800 :file tetD1_cut_length.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
evts = mkEvents(sp0,lD,49,50)
evts.med = median(evts)
evts.mad = apply(evts,1,mad)
plot_range = range(c(evts.med,evts.mad))
plot(evts.med,type="n",ylab="Amplitude",
     ylim=plot_range)
abline(v=seq(0,400,10),col="grey")
abline(h=c(0,1),col="grey")
lines(evts.med,lwd=2)
lines(evts.mad,col=2,lwd=2)
#+END_SRC

#+CAPTION: Setting the cut length for the data from tetrode D1 (channels 9, 10, 11, 12). We see that we need 15 points before the peak and 20 after.
#+RESULTS: cut-length-plot-tetD1
[[file:locust20000421_tetD1_fig/tetD1_cut_length.png]]

We see that we need roughly 15 points before the peak and 20 after.

** Events

We now cut our events:

#+NAME: lD-events-tetD1
#+BEGIN_SRC R :exports both :results output :session *R*
evts = mkEvents(sp0,lD,14,20)
summary(evts)
#+END_SRC

#+RESULTS: lD-events-tetD1
: 
: events object deriving from data set: lD.
:  Events defined as cuts of 35 sampling points on each of the 4 recording sites.
:  The 'reference' time of each event is located at point 15 of the cut.
:  There are 1184 events in the object.


We can as usual visualize the first 200 events with:

#+NAME: first-200-evts-tetD1
#+HEADER: :width 800 :height 800 :file first_200_evts_tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
evts[,1:200]
#+END_SRC

#+CAPTION: First 200 events for the data from tetrode D1 (channels 1, 3, 5, 7).
#+RESULTS: first-200-evts-tetD1
[[file:locust20000421_tetD1_fig/first_200_evts_tetD1.png]]

There are few superpositions so we try to remove the most obvious ones before doing the dimension reduction.

** Removing obvious superposition

Since some spikes have a pronounced early peak, we will look for superposition only on the late phase (last 10 points) of the events. We define function =goodEvtsFct= with:

#+NAME: goodEvtsFct
#+BEGIN_SRC R :session *R* :results silent
goodEvtsFct = function(samp,thr=3) {
    samp.med = apply(samp,1,median)
    samp.mad = apply(samp,1,mad)
    samp.r = apply(samp,2,function(x) {x[1:25] = 0;x})
    apply(samp.r,2,function(x) all(abs(x-samp.med) < thr*samp.mad))
}
#+END_SRC

We apply it with a threshold of 4 times the MAD:

#+NAME: goodEvts-4-MAD
#+BEGIN_SRC R :session *R* :results silent
goodEvts = goodEvtsFct(evts,4)
#+END_SRC

 
** Dimension reduction

We do a =PCA= on our good events set:

#+NAME: lD-evts-pca-tetD1
#+BEGIN_SRC R :session *R*
evts.pc = prcomp(t(evts[,goodEvts]))
#+END_SRC

#+RESULTS: lD-evts-pca-tetD1

We look at the projections on the first 4 principle components:

#+NAME: lD-evts-proj-first-4-pc-tetD1
#+HEADER: :width 800 :height 800 :file evts-proj-first-4-pc-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
panel.dens = function(x,...) {
  usr = par("usr")
  on.exit(par(usr))
  par(usr = c(usr[1:2], 0, 1.5) )
  d = density(x, adjust=0.5)
  x = d$x
  y = d$y
  y = y/max(y)
  lines(x, y, col="grey50", ...)
}
pairs(evts.pc$x[,1:4],pch=".",gap=0,diag.panel=panel.dens)
#+END_SRC

#+CAPTION: Events from tetrode D1 (channels 9, 10, 11, 12) projected onto the first 4 PCs.
#+RESULTS: lD-evts-proj-first-4-pc-tetD1
[[file:locust20000421_tetD1_fig/evts-proj-first-4-pc-tetD1.png]]

I see at least 4 clusters. We can also look at the projections on the PC pairs defined by the next 4 PCs:

#+NAME: lD-evts-proj-next-4-pc-tetD1
#+HEADER: :width 800 :height 800 :file evts-proj-next-4-pc-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
pairs(evts.pc$x[,5:8],pch=".",gap=0,diag.panel=panel.dens)
#+END_SRC

#+CAPTION: Events from tetrode D1 (channels 9, 10, 11, 12) projected onto PC 5 to 8.
#+RESULTS: lD-evts-proj-next-4-pc-tetD1
[[file:locust20000421_tetD1_fig/evts-proj-next-4-pc-tetD1.png]]

There is not much structure left beyond the 5th PC.

** Exporting for =GGobi=

We export the events projected onto the first 8 principle components in =csv= format:

#+NAME: evts-proj-to-csv-tetD1
#+BEGIN_SRC R :session *R*
write.csv(evts.pc$x[,1:8],file="tetD1_evts.csv")
#+END_SRC

#+RESULTS: evts-proj-to-csv-tetD1

Using the =rotation= display of =GGobi= with the first 3 principle components and the =2D tour= with the first 4 components I see at least 4 clusters but there are probably 5 or 6. So we will start with a =kmeans= with 5 centers.

** kmeans clustering with 6 and 5 clusters

#+NAME: kmeans-6-tetD1
#+BEGIN_SRC R :session *R* :results silent
nbc=6
set.seed(20110928,kind="Mersenne-Twister")
km = kmeans(evts.pc$x[,1:5],centers=nbc,iter.max=100,nstart=100)
label = km$cluster
cluster.med = sapply(1:nbc, function(cIdx) median(evts[,goodEvts][,label==cIdx]))
sizeC = sapply(1:nbc,function(cIdx) sum(abs(cluster.med[,cIdx])))
newOrder = sort.int(sizeC,decreasing=TRUE,index.return=TRUE)$ix
cluster.mad = sapply(1:nbc, function(cIdx) {ce = t(evts[,goodEvts]);ce = ce[label==cIdx,];apply(ce,2,mad)})
cluster.med = cluster.med[,newOrder]
cluster.mad = cluster.mad[,newOrder]
labelb = sapply(1:nbc, function(idx) (1:nbc)[newOrder==idx])[label]
#+END_SRC

 
We write a new =csv= file with the data and the labels:

#+NAME: evts-proj-and-labels-to-csv-tetD1
#+BEGIN_SRC R :session *R* :results silent
write.csv(cbind(evts.pc$x[,1:5],labelb),file="tetD1_sorted.csv")
#+END_SRC

It gives what was expected.

We get a plot showing the events attributed to each unit with:

#+NAME: kmeans-6-evts-from-each-tetD1
#+HEADER: :width 800 :height 1600 :file kmeans-6-evts-from-each-tetD1.png
#+BEGIN_SRC R :results output graphics :exports both :session *R*
layout(matrix(1:nbc,nr=nbc))
par(mar=c(1,1,1,1))
for (i in (1:nbc)) plot(evts[,goodEvts][,labelb==i],y.bar=5)
#+END_SRC

#+CAPTION: The events of the six clusters of tetrode D1 
#+RESULTS: kmeans-6-evts-from-each-tetD1
[[file:locust20000421_tetD1_fig/kmeans-6-evts-from-each-tetD1.png]]

2, 3 and 4 must be the same. 5 shows evidence that there are at least two neurons, and that some events were missed. We fuse clusters 1 and 2, 3 and 4 and we split 5.

#+NAME: kmeans-5-tetD1
#+BEGIN_SRC R :session *R* :results silent
nbc=5
labelb[labelb==3]=2
labelb[labelb==4]=2
kmB = kmeans(evts.pc$x[labelb==5,1:5],centers=2,iter.max=100,nstart=100)
labelB = kmB$cluster
c5_idx = (1:length(labelb))[labelb==5]
for (i in 1:length(c5_idx))
    labelb[c5_idx[i]] = ifelse(labelB[i]==1,3,4)
labelb[labelb==6]=5
#+END_SRC
 
We write a new =csv= file with the data and the labels:

#+NAME: evts-proj-and-labels-to-csv-tetD1b
#+BEGIN_SRC R :session *R* :results silent
write.csv(cbind(evts.pc$x[,1:5],labelb),file="tetD1b_sorted.csv")
#+END_SRC

We get a plot showing the events attributed to each unit with:

#+NAME: kmeans-5-evts-from-each-tetD1
#+HEADER: :width 800 :height 1600 :file kmeans-5-evts-from-each-tetD1.png
#+BEGIN_SRC R :results output graphics :exports both :session *R*
layout(matrix(1:nbc,nr=nbc))
par(mar=c(1,1,1,1))
for (i in (1:nbc)) {
    ei = labelb==i
    ni = sum(ei)
    plot(evts[,goodEvts][,ei][,1:ifelse(ni>200,200,ni)],y.bar=5)
}
#+END_SRC

#+CAPTION: The first 200 events of the five clusters of tetrode D1 
#+RESULTS: kmeans-5-evts-from-each-tetD1
[[file:locust20000421_tetD1_fig/kmeans-5-evts-from-each-tetD1.png]]

** Long cuts creation

For the peeling process we need templates that start and end at 0 (we will otherwise generate artifacts when we subtract). We proceed "as usual" with (I tried first with the default value for parameters =before= and =after= but I reduced their values after looking at the centers, see the next figure):

#+NAME: centers-tetD1
#+BEGIN_SRC R :session *R*
c_before = 49
c_after = 80
centers = lapply(1:nbc, function(i)
    mk_center_list(sp0[goodEvts][labelb==i],lD,
                   before=c_before,after=c_after))
names(centers) = paste("Cluster",1:nbc)
#+END_SRC

#+RESULTS: centers-tetD1
| Cluster 1 |
| Cluster 2 |
| Cluster 3 |
| Cluster 4 |
| Cluster 5 |


We then make sure that our cuts are long enough by looking at them:

#+NAME: centers-5u-tetD1-fig
#+HEADER: :width 800 :height 1600 :file centers-5u-tetD1.png
#+BEGIN_SRC R :results output graphics :exports both :session *R*
layout(matrix(1:nbc,nr=nbc))
par(mar=c(1,4,1,1))
the_range=c(min(sapply(centers,function(l) min(l$center))),
            max(sapply(centers,function(l) max(l$center))))
for (i in 1:nbc) {
    template = centers[[i]]$center
    plot(template,lwd=2,col=2,
         ylim=the_range,type="l",ylab="")
    abline(h=0,col="grey50")
    abline(v=(1:2)*(c_before+c_after)+1,col="grey50")
    lines(filter(template,rep(1,filter_length)/filter_length),
          col=1,lty=3,lwd=2)
    abline(h=-threshold_factor,col="grey",lty=2,lwd=2)
    lines(centers[[i]]$centerD,lwd=2,col=4)
}
#+END_SRC

#+CAPTION: The five templates (red) together with their first derivative (blue) all with the same scale. The dashed black curve show the templates filtered with the filter used during spike detection and the horizontal dashed grey line shows the detection threshold.
#+RESULTS: centers-5u-tetD1-fig
[[file:locust20000421_tetD1_fig/centers-5u-tetD1.png]]

Only unit 1 and 2 should reliably pass our threshold, we expect to miss some events from 5, while the other two should be multi-unit...

** Peeling

We can now do the peeling.

*** Round 0

We classify, predict, subtract and check how many non-classified events we get:

#+NAME: peeling-0-5u-tetD1
#+BEGIN_SRC R :exports both :session *R*
round0 = lapply(as.vector(sp0),classify_and_align_evt,
                data=lD,centers=centers,
                before=c_before,after=c_after)
pred0 = predict_data(round0,centers,data_length = dim(lD)[1])
lD_1 = lD - pred0
sum(sapply(round0, function(l) l[[1]] == '?'))
#+END_SRC

#+RESULTS: peeling-0-5u-tetD1
: 9

We can see the difference before / after peeling for the data between 1.1 and 1.2 s:

#+NAME: peeling-0-5u-tetD1-fig
#+HEADER: :width 800 :height 1000 :file peeling-0-5u-tetD1.png
#+BEGIN_SRC R :results output graphics :exports both :session *R*
ii = 1:1500 + 1.1*15000
tt = ii/15000
par(mar=c(1,1,1,1))
plot(tt, lD[ii,1], axes = FALSE,
     type="l",ylim=c(-50,10),
     xlab="",ylab="")
lines(tt, lD_1[ii,1], col='red')
lines(tt, lD[ii,2]-15, col='black')
lines(tt, lD_1[ii,2]-15, col='red')
lines(tt, lD[ii,3]-25, col='black')
lines(tt, lD_1[ii,3]-25, col='red')
lines(tt, lD[ii,4]-40, col='black')
lines(tt, lD_1[ii,4]-40, col='red')
#+END_SRC

#+CAPTION: The first peeling illustrated on 100 ms of data, the raw data are in black and the first subtration in red.
#+RESULTS: peeling-0-5u-tetD1-fig
[[file:locust20000421_tetD1_fig/peeling-0-5u-tetD1.png]]

*** Round 1

We keep going, using the subtracted data =lD_1= as "raw data", detecting on all sites using the original =MAD= for normalization and a shorter minimal allowed time between detected spikes:

#+NAME: peeling-1-5u-spike-detection-tetD1
#+BEGIN_SRC R :exports both :results output :session *R*
lDf = -lD_1
lDf = filter(lDf,rep(1,filter_length)/filter_length)
lDf[is.na(lDf)] = 0
lDf = t(t(lDf)/lDf_mad_original)
thrs = threshold_factor*c(1,1,1,1)
bellow.thrs = t(t(lDf) < thrs)
lDfr = lDf
lDfr[bellow.thrs] = 0
remove(lDf)
sp1 = peaks(apply(lDfr,1,sum),10)
remove(lDfr)
sp1
#+END_SRC

#+RESULTS: peeling-1-5u-spike-detection-tetD1
: 
: eventsPos object with indexes of 66 events. 
:   Mean inter event interval: 13465.78 sampling points, corresponding SD: 16215.94 sampling points 
:   Smallest and largest inter event intervals: 13 and 88036 sampling points.


We classify, predict, subtract and check how many non-classified events we get:

#+NAME: peeling-1-5u-tetD1
#+BEGIN_SRC R :exports both :session *R*
round1 = lapply(as.vector(sp1),classify_and_align_evt,
                data=lD_1,centers=centers,
                before=c_before,after=c_after)
pred1 = predict_data(round1,centers,data_length = dim(lD)[1])
lD_2 = lD_1 - pred1
sum(sapply(round1, function(l) l[[1]] == '?'))
#+END_SRC

#+RESULTS: peeling-1-5u-tetD1
: 13

We look at what's left with (not shown):

#+NAME: check-after-round1
#+BEGIN_SRC R :eval never
explore(sp1,lD_2,col=c("black","grey50"))
#+END_SRC

We decide to stop here.

** Getting the spike trains

#+NAME: spike-trains-5u-tetD1
#+BEGIN_SRC R :session *R*
round_all = c(round0,round1)
spike_trains = lapply(paste("Cluster",1:nbc),
                      function(cn) sort(sapply(round_all[sapply(round_all,
                                                           function(l) l[[1]]==cn)],
                                          function(l) l[[2]]+l[[3]])))
names(spike_trains) = paste("Cluster",1:nbc)
#+END_SRC

#+RESULTS: spike-trains-5u-tetD1
| Cluster 1 |
| Cluster 2 |
| Cluster 3 |
| Cluster 4 |
| Cluster 5 |

** Getting the inter spike intervals and the forward and backward recurrence times

*** ISI distributions
We first get the =ISI= (inter spike intervals) of each unit:

#+NAME: isi_from_each
#+BEGIN_SRC R :session *R* :results silent
isi = sapply(spike_trains, diff)
names(isi) = names(spike_trains)
#+END_SRC

We get the ISI ECDF for the five units with:

#+NAME: isi-ecdf-5u-tetD1
#+HEADER: :width 800 :height 800 :file isi-ecdf-5u-tetD1.png
#+BEGIN_SRC R :session *R* :results output graphics :exports both
layout(matrix(1:(nbc+nbc %% 2),nr=ceiling(nbc/2)))
par(mar=c(4,5,6,1))
for (cn in names(isi)) plot_isi(isi[[cn]],main=cn)
#+END_SRC

#+CAPTION: ISI ECDF for the five units.
#+RESULTS: isi-ecdf-5u-tetD1
[[file:locust20000421_tetD1_fig/isi-ecdf-5u-tetD1.png]]

*** Forward and Backward Recurrence Times
The forward recurrence time (=FRT=) between neuron A and B is the elapsed time between a spike in A and the next spike in B. The backward recurrence time (=BRT=) is the same thing except that we look for the former spike in B. If A and B are not correlated, the expected density of the FRT is the survival function (1-CDF) of the ISI from B divided by the mean ISI of B (the same holds for the BRT under the null hypothesis after taking the opposite). All that is correct if the data are /stationary/.
  
On the data at hand that gives:

#+NAME: rt-test-5u-tetD1
#+HEADER: :width 1200 :height 1200 :file rt-test-5u-tetD1.png
#+BEGIN_SRC R :session *R* :results output graphics :exports both
layout_matrix = matrix(0,nr=nbc,nc=nbc)
counter = 1
for (i in 1:nbc)
    for (j in 1:nbc)
        if (i != j) {
            layout_matrix[i,j] = counter
            counter = counter +1
        }
layout(layout_matrix)
par(mar=c(4,3,4,1))
for (i in 1:nbc)
    for (j in 1:nbc)
        if (i != j)
            test_rt(spike_trains[[i]],
                    spike_trains[[j]],
                    ylab="",main=paste("Units",i,"and",j))
#+END_SRC

#+CAPTION: Graphical tests of the Backward and Forward Reccurrence Times distrution agaisnt the null hypothesis (no interaction). If the null is correct, the curves should be IID draws from a standard normal distribution.
#+RESULTS: rt-test-5u-tetD1
[[file:locust20000421_tetD1_fig/rt-test-5u-tetD1.png]]

** Testing =all_at_once=

We test the function with:

#+NAME: all_at_once-test
#+BEGIN_SRC R :results output :exports both :session *R*
## We need again an un-normalized version of the data
ref_data = rbind(cbind(h5read("locust20000421.hdf5", "/Spontaneous/ch9"),
                       h5read("locust20000421.hdf5", "/Spontaneous/ch10"),
                       h5read("locust20000421.hdf5", "/Spontaneous/ch11"),
                       h5read("locust20000421.hdf5", "/Spontaneous/ch12")))
## We can now use our function
aao=all_at_once(data=ref_data, centers, thres=threshold_factor*c(1,1,1,1), 
                filter_length_1=filter_length, filter_length=filter_length, 
                minimalDist_1=15, minimalDist=10, 
                before=c_before, after=c_after, 
                detection_cycle=c(0,0), verbose=2)
#+END_SRC

#+RESULTS: all_at_once-test
#+begin_example
The five number summary is:
       V1             V2             V3             V4      
 Min.   : 746   Min.   :1653   Min.   :1497   Min.   :1398  
 1st Qu.:2005   1st Qu.:1992   1st Qu.:2013   1st Qu.:2011  
 Median :2048   Median :2033   Median :2055   Median :2054  
 Mean   :2047   Mean   :2033   Mean   :2054   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2074   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :2996   Max.   :2423   Max.   :2524   Max.   :2581  

Doing now round 0 detecting on all sites
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
     1184       170       407       174       132       292         9 

Doing now round 1 detecting on all sites
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       66         4         5        11         8        25        13 

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
     1247       174       412       185       140       317        19
#+end_example


We see that we are getting back the numbers we obtained before step by step.

We can compare the "old" and "new" centers with (not shown):

#+NAME: all_at_once-center-comp-sterCa
#+BEGIN_SRC R :eval never 
layout(matrix(1:nbc,nr=nbc))
par(mar=c(1,4,1,1))
for (i in 1:nbc) {
    plot(centers[[i]]$center,lwd=2,col=2,
         ylim=the_range,type="l")
    abline(h=0,col="grey50")
    abline(v=(c_before+c_after)+1,col="grey50")
    lines(aao$centers[[i]]$center,lwd=1,col=4)
}
#+END_SRC

They are not exactly identical since the new version is computed with all events (superposed or not) attributed to each neuron.

* Analyzing a sequence of trials

** Create a directory were results get saved

We will carry out an analysis of sequences of 30/25 trials with a given odor. At the end of the analysis of the sequence we will save some intermediate =R= object in a directory we are now creating.:

#+NAME: create-tetD1_analysis
#+BEGIN_SRC R :session *R* :results silent
if (!dir.exists("tetD1_analysis"))
    dir.create("tetD1_analysis")
#+END_SRC

** Define a "taylored" version of =sort_many_trials=

In order to save space and to avoid typos, we define next a taylored version of =sort_many_trials=:

#+NAME: smt
#+BEGIN_SRC R :session *R* :results silent
smt = function(stim_name,
               trial_nbs,
               centers,
               counts) {
    sort_many_trials(inter_trial_time=10*15000,
                     get_data_fct=function(i,s) get_data(i,s,
                                                         channels = c("ch09","ch10","ch11","ch12"),
                                                         file="locust20000421.hdf5"),
                     stim_name=stim_name,
                     trial_nbs=trial_nbs,
                     centers=centers,
                     counts=counts,
                     all_at_once_call_list=list(thres=threshold_factor*c(1,1,1,1), 
                                                filter_length_1=filter_length, filter_length=filter_length, 
                                                minimalDist_1=15, minimalDist=10, 
                                                before=c_before, after=c_after, 
                                                detection_cycle=c(0,0), verbose=1),
                     layout_matrix=matrix(1:6,nr=3),new_weight_in_update=0.01
                     )
}
#+END_SRC


* Systematic analysis of the 30 trials from =1-Hexanol=

The =LabBook= mentions that a drop of solution was added at trial 13 but looking at the data, no major corruption occurs except for a very sharp artifact so we keep that trial.

** Doing the job

#+NAME: 1-Hexanol-tetD1
#+BEGIN_SRC R :exports both :results output :session *R*
a_1_Hexanol_tetD1=smt(stim_name="1-Hexanol",
                      trial_nbs=1:30,
                      centers=aao$centers,
                      counts=aao$counts)
#+END_SRC

#+RESULTS: 1-Hexanol-tetD1
#+begin_example
***************
Doing now trial 1 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1226   Min.   :1697   Min.   :1662   Min.   :1540  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2076   3rd Qu.:2094   3rd Qu.:2095  
 Max.   :3011   Max.   :2382   Max.   :2566   Max.   :2531  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      101         9        30        21        10        30         1 
Trial 1 done!
******************
***************
Doing now trial 2 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1171   Min.   :1702   Min.   :1557   Min.   :1510  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2075   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :2987   Max.   :2391   Max.   :2485   Max.   :2526  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      125         4        42        24        11        40         4 
Trial 2 done!
******************
***************
Doing now trial 3 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 975   Min.   :1683   Min.   :1546   Min.   :1516  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2010  
 Median :2049   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2096   3rd Qu.:2097  
 Max.   :3067   Max.   :2404   Max.   :2535   Max.   :2528  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      262        47       101        15        17        75         7 
Trial 3 done!
******************
***************
Doing now trial 4 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1155   Min.   :1686   Min.   :1624   Min.   :1493  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2075   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3057   Max.   :2409   Max.   :2554   Max.   :2561  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      175        15        56        26        10        67         1 
Trial 4 done!
******************
***************
Doing now trial 5 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1160   Min.   :1670   Min.   :1610   Min.   :1523  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :2912   Max.   :2398   Max.   :2478   Max.   :2544  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      135         2        72        21        22        17         1 
Trial 5 done!
******************
***************
Doing now trial 6 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1088   Min.   :1703   Min.   :1558   Min.   :1463  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2096   3rd Qu.:2096  
 Max.   :3005   Max.   :2431   Max.   :2517   Max.   :2557  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      201        44        75        14         8        56         4 
Trial 6 done!
******************
***************
Doing now trial 7 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1066   Min.   :1705   Min.   :1608   Min.   :1517  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2096  
 Max.   :3121   Max.   :2459   Max.   :2571   Max.   :2567  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      163        17        60        26        14        44         2 
Trial 7 done!
******************
***************
Doing now trial 8 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1110   Min.   :1703   Min.   :1586   Min.   :1557  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3113   Max.   :2363   Max.   :2526   Max.   :2536  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      211        30        68        28        15        67         3 
Trial 8 done!
******************
***************
Doing now trial 9 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1065   Min.   :1670   Min.   :1573   Min.   :1543  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2010  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2096   3rd Qu.:2096  
 Max.   :3100   Max.   :2393   Max.   :2500   Max.   :2549  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      217        21        73        24        15        83         1 
Trial 9 done!
******************
***************
Doing now trial 10 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1106   Min.   :1711   Min.   :1595   Min.   :1486  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3083   Max.   :2386   Max.   :2530   Max.   :2557  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      118        10        47        16         8        36         1 
Trial 10 done!
******************
***************
Doing now trial 11 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1003   Min.   :1703   Min.   :1567   Min.   :1464  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2010  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2096  
 Max.   :3024   Max.   :2413   Max.   :2575   Max.   :2528  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      220        25       111        16        16        50         2 
Trial 11 done!
******************
***************
Doing now trial 12 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1097   Min.   :1731   Min.   :1555   Min.   :1519  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3085   Max.   :2390   Max.   :2533   Max.   :2513  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      119         2        44        20         7        44         2 
Trial 12 done!
******************
***************
Doing now trial 13 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 833   Min.   :   0   Min.   :1346   Min.   :1185  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2094   3rd Qu.:2095  
 Max.   :4095   Max.   :2795   Max.   :4095   Max.   :4095  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      145        12        37        19        16        57         4 
Trial 13 done!
******************
***************
Doing now trial 14 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 955   Min.   :1741   Min.   :1556   Min.   :1431  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2047   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2096  
 Max.   :3170   Max.   :2384   Max.   :2517   Max.   :2598  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      144         6        74        22         8        31         3 
Trial 14 done!
******************
***************
Doing now trial 15 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 962   Min.   :1644   Min.   :1531   Min.   :1519  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2011   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3111   Max.   :2405   Max.   :2529   Max.   :2546  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      201        36        62        20        13        65         5 
Trial 15 done!
******************
***************
Doing now trial 16 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 994   Min.   :1685   Min.   :1565   Min.   :1526  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3109   Max.   :2446   Max.   :2508   Max.   :2577  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      154        23        56        16         4        53         2 
Trial 16 done!
******************
***************
Doing now trial 17 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 974   Min.   :1673   Min.   :1579   Min.   :1509  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2010  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3116   Max.   :2419   Max.   :2579   Max.   :2579  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      146        15        54        10        16        49         2 
Trial 17 done!
******************
***************
Doing now trial 18 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1049   Min.   :1715   Min.   :1478   Min.   :1493  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2010  
 Median :2049   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2096  
 Max.   :3161   Max.   :2469   Max.   :2579   Max.   :2616  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      202        41        63        10        11        74         3 
Trial 18 done!
******************
***************
Doing now trial 19 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 848   Min.   :1722   Min.   :1557   Min.   :1519  
 1st Qu.:2002   1st Qu.:1990   1st Qu.:2010   1st Qu.:2010  
 Median :2049   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2096   3rd Qu.:2076   3rd Qu.:2096   3rd Qu.:2096  
 Max.   :3123   Max.   :2443   Max.   :2526   Max.   :2580  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      320        35       115         8        13       142         7 
Trial 19 done!
******************
***************
Doing now trial 20 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1029   Min.   :1679   Min.   :1533   Min.   :1512  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3116   Max.   :2364   Max.   :2491   Max.   :2527  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      158        14        70        12        10        50         2 
Trial 20 done!
******************
***************
Doing now trial 21 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 954   Min.   :1699   Min.   :1645   Min.   :1542  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3068   Max.   :2425   Max.   :2573   Max.   :2516  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      125         7        67        11         8        32         0 
Trial 21 done!
******************
***************
Doing now trial 22 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1006   Min.   :1694   Min.   :1533   Min.   :1508  
 1st Qu.:2003   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2034   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2094   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2096  
 Max.   :3194   Max.   :2419   Max.   :2562   Max.   :2506  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      204        25        87        14        14        59         5 
Trial 22 done!
******************
***************
Doing now trial 23 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 638   Min.   :1727   Min.   :1525   Min.   :1438  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2094  
 Max.   :3277   Max.   :2439   Max.   :2602   Max.   :2560  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      139        22        40         9        11        54         3 
Trial 23 done!
******************
***************
Doing now trial 24 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1007   Min.   :1660   Min.   :1564   Min.   :1541  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3143   Max.   :2357   Max.   :2555   Max.   :2510  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      160        32        44        16         8        56         4 
Trial 24 done!
******************
***************
Doing now trial 25 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 990   Min.   :1693   Min.   :1568   Min.   :1492  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3092   Max.   :2385   Max.   :2521   Max.   :2559  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      188        29        67        17         7        63         5 
Trial 25 done!
******************
***************
Doing now trial 26 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 895   Min.   :1678   Min.   :1528   Min.   :1518  
 1st Qu.:2004   1st Qu.:1991   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3150   Max.   :2388   Max.   :2542   Max.   :2533  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      198        32        66        13        10        74         3 
Trial 26 done!
******************
***************
Doing now trial 27 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 957   Min.   :1650   Min.   :1543   Min.   :1516  
 1st Qu.:2003   1st Qu.:1992   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2093   3rd Qu.:2076   3rd Qu.:2095   3rd Qu.:2095  
 Max.   :3137   Max.   :2385   Max.   :2530   Max.   :2555  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      195        33        57        13         6        81         5 
Trial 27 done!
******************
***************
Doing now trial 28 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 992   Min.   :1636   Min.   :1517   Min.   :1555  
 1st Qu.:2004   1st Qu.:1992   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2075   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3068   Max.   :2379   Max.   :2541   Max.   :2476  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      164        31        51         6        12        61         3 
Trial 28 done!
******************
***************
Doing now trial 29 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1022   Min.   :1697   Min.   :1599   Min.   :1574  
 1st Qu.:2005   1st Qu.:1992   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2034   Median :2054   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2075   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3130   Max.   :2384   Max.   :2550   Max.   :2507  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      124        14        58         6         5        38         3 
Trial 29 done!
******************
***************
Doing now trial 30 of 1-Hexanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1073   Min.   :1753   Min.   :1628   Min.   :1552  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3045   Max.   :2374   Max.   :2489   Max.   :2487  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       99         4        34        16         7        34         4 
Trial 30 done!
******************
#+end_example



** Diagnostic plots

The counts evolution is:

#+NAME: 1-Hexanol-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Hexanol-count-evolution-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
counts_evolution(a_1_Hexanol_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 30 trials of =1-Hexanol= for tetrode D1.
#+RESULTS: 1-Hexanol-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Hexanol-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Hexanol-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Hexanol-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
waveform_evolution(a_1_Hexanol_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 30 trials with =1-Hexanol= for tetrode D1.
#+RESULTS: 1-Hexanol-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Hexanol-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities ad raster plots are:

#+NAME: 1-Hexanol-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1400 :file 1-Hexanol-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
cp_isi_raster(a_1_Hexanol_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Hexanol.
#+RESULTS: 1-Hexanol-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/1-Hexanol-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Hexanol
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Hexanol_tetD1,
     file=paste0("tetD1_analysis/tetD1_","1-Hexanol","_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Hexanol_tetD1$spike_trains))
    cat(a_1_Hexanol_tetD1$spike_trains[[c_idx]],
        file=paste0("locust20000421_spike_trains/locust20000421_1-Hexanol_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Hexanal=

We will carry out an analysis of the 25 trials from =Hexanal=. The =LabBook= mentions that a drop of solution was added at trial 18 but looking at the data, no major corruption occurs except for a very sharp artifact:

** Do the job

#+NAME: Hexanal-tetD1
#+BEGIN_SRC R :exports both :results output :session *R*
a_Hexanal_tetD1=smt(stim_name="Hexanal",
                    trial_nbs=1:25,
                    centers=a_1_Hexanol_tetD1$centers,
                    counts=a_1_Hexanol_tetD1$counts)
#+END_SRC

#+RESULTS: Hexanal-tetD1
#+begin_example
***************
Doing now trial 1 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 952   Min.   :1720   Min.   :1508   Min.   :1577  
 1st Qu.:2005   1st Qu.:1992   1st Qu.:2013   1st Qu.:2011  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3175   Max.   :2409   Max.   :2532   Max.   :2480  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      153        28        26        16        10        65         8 
Trial 1 done!
******************
***************
Doing now trial 2 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   :1002   Min.   :1676   Min.   :1638   Min.   :1620  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2094  
 Max.   :3158   Max.   :2356   Max.   :2519   Max.   :2438  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      136        12        23        17        14        66         4 
Trial 2 done!
******************
***************
Doing now trial 3 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 853   Min.   :1733   Min.   :1582   Min.   :1636  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2092   3rd Qu.:2075   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3201   Max.   :2329   Max.   :2542   Max.   :2449  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      197        37        18        15         3       116         8 
Trial 3 done!
******************
***************
Doing now trial 4 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 915   Min.   :1765   Min.   :1522   Min.   :1631  
 1st Qu.:2004   1st Qu.:1992   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2094   3rd Qu.:2094  
 Max.   :3148   Max.   :2419   Max.   :2532   Max.   :2486  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      193        13        18        22         1       137         2 
Trial 4 done!
******************
***************
Doing now trial 5 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 900   Min.   :1766   Min.   :1574   Min.   :1609  
 1st Qu.:2004   1st Qu.:1993   1st Qu.:2013   1st Qu.:2011  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2094  
 Max.   :3135   Max.   :2353   Max.   :2582   Max.   :2429  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      202        16        30        27         7       114         8 
Trial 5 done!
******************
***************
Doing now trial 6 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 977   Min.   :1721   Min.   :1507   Min.   :1638  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2053  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2094  
 Max.   :3176   Max.   :2364   Max.   :2555   Max.   :2458  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      152        32        34        28         7        41        10 
Trial 6 done!
******************
***************
Doing now trial 7 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 953   Min.   :1651   Min.   :1592   Min.   :1656  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3114   Max.   :2364   Max.   :2517   Max.   :2497  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       97        16        13        20         5        42         1 
Trial 7 done!
******************
***************
Doing now trial 8 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 949   Min.   :1715   Min.   :1541   Min.   :1671  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3172   Max.   :2391   Max.   :2528   Max.   :2438  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      162        27        20        41         7        58         9 
Trial 8 done!
******************
***************
Doing now trial 9 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 944   Min.   :1733   Min.   :1582   Min.   :1614  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2012   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3125   Max.   :2410   Max.   :2527   Max.   :2420  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      195        31        22        47        10        79         6 
Trial 9 done!
******************
***************
Doing now trial 10 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 893   Min.   :1737   Min.   :1567   Min.   :1665  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3199   Max.   :2353   Max.   :2488   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      252        43         8        37        12       146         6 
Trial 10 done!
******************
***************
Doing now trial 11 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 704   Min.   :1722   Min.   :1508   Min.   :1668  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2012   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2092   3rd Qu.:2074   3rd Qu.:2094   3rd Qu.:2093  
 Max.   :3138   Max.   :2383   Max.   :2544   Max.   :2446  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      291        38        12        70        20       139        12 
Trial 11 done!
******************
***************
Doing now trial 12 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 738   Min.   :1641   Min.   :1546   Min.   :1647  
 1st Qu.:2006   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3191   Max.   :2377   Max.   :2457   Max.   :2461  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      144        24         7        48        10        51         4 
Trial 12 done!
******************
***************
Doing now trial 13 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 925   Min.   :1743   Min.   :1571   Min.   :1641  
 1st Qu.:2006   1st Qu.:1993   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2033   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3114   Max.   :2348   Max.   :2523   Max.   :2418  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      186        52         5        45         7        69         8 
Trial 13 done!
******************
***************
Doing now trial 14 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 963   Min.   :1751   Min.   :1516   Min.   :1699  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3147   Max.   :2366   Max.   :2486   Max.   :2401  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      131        26         5        43         8        46         3 
Trial 14 done!
******************
***************
Doing now trial 15 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 950   Min.   :1661   Min.   :1571   Min.   :1634  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3158   Max.   :2339   Max.   :2461   Max.   :2428  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       91         5         5        42         4        31         4 
Trial 15 done!
******************
***************
Doing now trial 16 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 845   Min.   :1726   Min.   :1520   Min.   :1603  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3186   Max.   :2348   Max.   :2537   Max.   :2393  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      218        48         2        46        11        99        12 
Trial 16 done!
******************
***************
Doing now trial 17 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 929   Min.   :1726   Min.   :1585   Min.   :1717  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3120   Max.   :2343   Max.   :2518   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      137        29         2        28        11        64         3 
Trial 17 done!
******************
***************
Doing now trial 18 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 711   Min.   :1084   Min.   :1528   Min.   :1490  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3652   Max.   :2586   Max.   :2948   Max.   :2861  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      217        43         1        54        19        88        12 
Trial 18 done!
******************
***************
Doing now trial 19 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 658   Min.   :1717   Min.   :1564   Min.   :1672  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3131   Max.   :2331   Max.   :2536   Max.   :2401  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      193        41         3        36        12        88        13 
Trial 19 done!
******************
***************
Doing now trial 20 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 943   Min.   :1743   Min.   :1565   Min.   :1674  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3117   Max.   :2413   Max.   :2524   Max.   :2453  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      140        29         0        40        11        54         6 
Trial 20 done!
******************
***************
Doing now trial 21 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 912   Min.   :1718   Min.   :1598   Min.   :1659  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3140   Max.   :2364   Max.   :2498   Max.   :2395  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      136        19         4        34         7        59        13 
Trial 21 done!
******************
***************
Doing now trial 22 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 703   Min.   :1717   Min.   :1508   Min.   :1643  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3158   Max.   :2358   Max.   :2539   Max.   :2423  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      206        49         1        49        13        87         7 
Trial 22 done!
******************
***************
Doing now trial 23 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 940   Min.   :1759   Min.   :1632   Min.   :1637  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3222   Max.   :2376   Max.   :2506   Max.   :2414  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      143        17         0        39         8        77         2 
Trial 23 done!
******************
***************
Doing now trial 24 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 906   Min.   :1740   Min.   :1512   Min.   :1720  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3140   Max.   :2405   Max.   :2512   Max.   :2428  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        29         2        36         7        85         7 
Trial 24 done!
******************
***************
Doing now trial 25 of Hexanal
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 890   Min.   :1695   Min.   :1557   Min.   :1653  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2048   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3177   Max.   :2402   Max.   :2517   Max.   :2448  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      186        40         1        29        11       101         4 
Trial 25 done!
******************
#+end_example



** Diagnostic plots

The counts evolution is:

#+NAME: Hexanal-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Hexanal-count-evolution-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
counts_evolution(a_Hexanal_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Hexanal= for tetrode D1.
#+RESULTS: Hexanal-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/Hexanal-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Hexanal-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Hexanal-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
waveform_evolution(a_Hexanal_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Hexanal= for tetrode D1.
#+RESULTS: Hexanal-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/Hexanal-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Hexanal-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Hexanal-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
cp_isi_raster(a_Hexanal_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Hexanal.
#+RESULTS: Hexanal-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/Hexanal-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Hexanal
#+BEGIN_SRC R :session *R* :results silent
save(a_Hexanal_tetD1,
     file=paste0("tetD1_analysis/tetD1_","Hexanal","_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Hexanal_tetD1$spike_trains))
    cat(a_Hexanal_tetD1$spike_trains[[c_idx]],
        file=paste0("locust20000421_spike_trains/locust20000421_Hexanal_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Cis-3-Hexen-1-ol=

We will carry out an analysis of the 25 trials from =Cis-3-Hexen-1-ol=.  

** Do the job

We do not print out the output to save space.

#+NAME: Cis-3-Hexen-1-ol-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
a_Cis_3_Hexen_1_ol_tetD1=smt(stim_name="Cis-3-Hexen-1-ol",
                             trial_nbs=1:25,
                             centers=a_Hexanal_tetD1$centers,
                             counts=a_Hexanal_tetD1$counts)
#+END_SRC

#+RESULTS: Cis-3-Hexen-1-ol-tetD1
#+begin_example
***************
Doing now trial 1 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 835   Min.   :1731   Min.   :1500   Min.   :1609  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3253   Max.   :2411   Max.   :2531   Max.   :2424  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      168        46         2        38         7        71         4 
Trial 1 done!
******************
***************
Doing now trial 2 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 837   Min.   :1695   Min.   :1515   Min.   :1656  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3243   Max.   :2332   Max.   :2546   Max.   :2434  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      121        30         0        21         3        63         4 
Trial 2 done!
******************
***************
Doing now trial 3 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 815   Min.   :1737   Min.   :1529   Min.   :1662  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3246   Max.   :2352   Max.   :2502   Max.   :2418  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      117        32         1        19         7        55         3 
Trial 3 done!
******************
***************
Doing now trial 4 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 882   Min.   :1700   Min.   :1556   Min.   :1628  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3253   Max.   :2368   Max.   :2582   Max.   :2440  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      107        30         0        15         8        53         1 
Trial 4 done!
******************
***************
Doing now trial 5 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 865   Min.   :1728   Min.   :1560   Min.   :1701  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3276   Max.   :2339   Max.   :2528   Max.   :2388  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       95        14         0        26         4        43         8 
Trial 5 done!
******************
***************
Doing now trial 6 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 574   Min.   :1717   Min.   :1548   Min.   :1677  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3320   Max.   :2362   Max.   :2596   Max.   :2440  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      132        29         0        20         4        73         6 
Trial 6 done!
******************
***************
Doing now trial 7 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 829   Min.   :1691   Min.   :1514   Min.   :1594  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2054   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3285   Max.   :2409   Max.   :2525   Max.   :2471  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      162        40         2        21         6        85         8 
Trial 7 done!
******************
***************
Doing now trial 8 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 750   Min.   :1731   Min.   :1575   Min.   :1658  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2053   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3327   Max.   :2392   Max.   :2569   Max.   :2490  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      153        26         0        29         8        83         7 
Trial 8 done!
******************
***************
Doing now trial 9 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 828   Min.   :1701   Min.   :1555   Min.   :1694  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3321   Max.   :2353   Max.   :2556   Max.   :2399  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       76         9         0        23         8        32         4 
Trial 9 done!
******************
***************
Doing now trial 10 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 826   Min.   :1707   Min.   :1558   Min.   :1646  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3262   Max.   :2368   Max.   :2548   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      179        49         0        26         6        88        10 
Trial 10 done!
******************
***************
Doing now trial 11 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 794   Min.   :1710   Min.   :1407   Min.   :1565  
 1st Qu.:2005   1st Qu.:1993   1st Qu.:2012   1st Qu.:2011  
 Median :2048   Median :2034   Median :2053   Median :2054  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2092   3rd Qu.:2075   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3321   Max.   :2346   Max.   :2543   Max.   :2489  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      239        70         1        49        13        97         9 
Trial 11 done!
******************
***************
Doing now trial 12 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 768   Min.   :1734   Min.   :1541   Min.   :1691  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3291   Max.   :2364   Max.   :2556   Max.   :2514  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      138        30         0        21         5        72        10 
Trial 12 done!
******************
***************
Doing now trial 13 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 760   Min.   :1711   Min.   :1525   Min.   :1595  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3262   Max.   :2369   Max.   :2525   Max.   :2459  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      175        44         0        35         2        82        12 
Trial 13 done!
******************
***************
Doing now trial 14 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 705   Min.   :1701   Min.   :1496   Min.   :1601  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3325   Max.   :2428   Max.   :2519   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      118        30         1        22         7        48        10 
Trial 14 done!
******************
***************
Doing now trial 15 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 645   Min.   :1723   Min.   :1525   Min.   :1651  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3425   Max.   :2421   Max.   :2548   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      165        34         0        27         5        78        21 
Trial 15 done!
******************
***************
Doing now trial 16 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 669   Min.   :1720   Min.   :1522   Min.   :1632  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3390   Max.   :2413   Max.   :2527   Max.   :2425  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      207        61         1        26         9        83        27 
Trial 16 done!
******************
***************
Doing now trial 17 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 655   Min.   :1701   Min.   :1531   Min.   :1684  
 1st Qu.:2007   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3395   Max.   :2422   Max.   :2507   Max.   :2456  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       91        13         1         8        11        45        13 
Trial 17 done!
******************
***************
Doing now trial 18 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 669   Min.   :1680   Min.   :1506   Min.   :1547  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2053   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2093   3rd Qu.:2093  
 Max.   :3404   Max.   :2361   Max.   :2627   Max.   :2471  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      189        47         2        36        11        68        25 
Trial 18 done!
******************
***************
Doing now trial 19 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 586   Min.   :1701   Min.   :1513   Min.   :1639  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3408   Max.   :2370   Max.   :2567   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      107        18         1        17         5        47        19 
Trial 19 done!
******************
***************
Doing now trial 20 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 665   Min.   :1708   Min.   :1527   Min.   :1643  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2034   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3406   Max.   :2368   Max.   :2552   Max.   :2418  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       98        15         0        17         9        40        17 
Trial 20 done!
******************
***************
Doing now trial 21 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 699   Min.   :1682   Min.   :1490   Min.   :1649  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3446   Max.   :2345   Max.   :2625   Max.   :2446  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      165        37         0        23         2        71        32 
Trial 21 done!
******************
***************
Doing now trial 22 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 578   Min.   :1702   Min.   :1500   Min.   :1656  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3456   Max.   :2405   Max.   :2648   Max.   :2426  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      210        52         0        33         9        84        32 
Trial 22 done!
******************
***************
Doing now trial 23 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 683   Min.   :1701   Min.   :1482   Min.   :1600  
 1st Qu.:2007   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3384   Max.   :2399   Max.   :2582   Max.   :2451  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      124        25         0        26         6        48        19 
Trial 23 done!
******************
***************
Doing now trial 24 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 609   Min.   :1624   Min.   :1498   Min.   :1671  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3439   Max.   :2381   Max.   :2562   Max.   :2457  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      173        38         0        32        12        65        26 
Trial 24 done!
******************
***************
Doing now trial 25 of Cis-3-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 537   Min.   :1737   Min.   :1561   Min.   :1585  
 1st Qu.:2007   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3426   Max.   :2392   Max.   :2537   Max.   :2392  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       93        14         0        21         6        36        16 
Trial 25 done!
******************
#+end_example


** Diagnostic plots

The counts evolution is:

#+NAME: Cis-3-Hexen-1-ol-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Cis-3-Hexen-1-ol-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Cis_3_Hexen_1_ol_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 30 trials of =Cis-3-Hexen-1-ol= for tetrode D1.
#+RESULTS: Cis-3-Hexen-1-ol-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/Cis-3-Hexen-1-ol-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Cis-3-Hexen-1-ol-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Cis-3-Hexen-1-ol-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports resutls :results output graphics :session *R*
waveform_evolution(a_Cis_3_Hexen_1_ol_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Cis-3-Hexen-1-ol= for stereode Ca.
#+RESULTS: Cis-3-Hexen-1-ol-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/Cis-3-Hexen-1-ol-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Cis-3-Hexen-1-ol-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1000 :file Cis-3-Hexen-1-ol-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Cis_3_Hexen_1_ol_tetD1,layout_matrix=matrix(1:12,nr=4,byrow=TRUE))
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Cis-3-Hexen-1-ol.
#+RESULTS: Cis-3-Hexen-1-ol-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/Cis-3-Hexen-1-ol-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Cis-3-Hexen-1-ol
#+BEGIN_SRC R :session *R* :results silent
save(a_Cis_3_Hexen_1_ol_tetD1,
     file=paste0("tetD1_analysis/tetD1_","Cis-3-Hexen-1-ol","_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Cis_3_Hexen_1_ol_tetD1$spike_trains))
    if (!is.null(a_Cis_3_Hexen_1_ol_tetD1$spike_trains[[c_idx]]))
        cat(a_Cis_3_Hexen_1_ol_tetD1$spike_trains[[c_idx]],
	    file=paste0("locust20000421_spike_trains/locust20000421_Cis-3-Hexen-1-ol_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Trans-2-Hexen-1-ol=

We will carry out an analysis of the 25 trials from =Trans-2-Hexen-1-ol=. 
** Do the job

#+NAME: Trans-2-Hexen-1-ol-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Trans-2-Hexen-1-ol"
a_Trans_2_Hexen_1_ol_tetD1=smt(stim_name=stim_name,
                               trial_nbs=1:25,
                               centers=a_Cis_3_Hexen_1_ol_tetD1$centers,
                               counts=a_Cis_3_Hexen_1_ol_tetD1$counts)
#+END_SRC

#+RESULTS: Trans-2-Hexen-1-ol-tetD1
#+begin_example
***************
Doing now trial 1 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 639   Min.   :1709   Min.   :1511   Min.   :1652  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3443   Max.   :2510   Max.   :2553   Max.   :2450  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      200        37         2        34        16        87        24 
Trial 1 done!
******************
***************
Doing now trial 2 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 681   Min.   :1681   Min.   :1527   Min.   :1618  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3500   Max.   :2421   Max.   :2518   Max.   :2439  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      182        39         1        41        25        55        21 
Trial 2 done!
******************
***************
Doing now trial 3 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 697   Min.   :1681   Min.   :1534   Min.   :1653  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3463   Max.   :2372   Max.   :2546   Max.   :2437  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      173        45         0        38        12        63        15 
Trial 3 done!
******************
***************
Doing now trial 4 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 682   Min.   :1687   Min.   :1509   Min.   :1640  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3309   Max.   :2461   Max.   :2513   Max.   :2422  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      128        32         0        21        13        49        13 
Trial 4 done!
******************
***************
Doing now trial 5 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 665   Min.   :1636   Min.   :1512   Min.   :1673  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3370   Max.   :2367   Max.   :2516   Max.   :2496  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      182        48         0        26        16        78        14 
Trial 5 done!
******************
***************
Doing now trial 6 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 722   Min.   :1689   Min.   :1543   Min.   :1679  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3392   Max.   :2366   Max.   :2538   Max.   :2405  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      115        22         0        21        17        46         9 
Trial 6 done!
******************
***************
Doing now trial 7 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 709   Min.   :1725   Min.   :1564   Min.   :1665  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3319   Max.   :2383   Max.   :2567   Max.   :2485  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      189        45         0        25        11        92        16 
Trial 7 done!
******************
***************
Doing now trial 8 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 677   Min.   :1727   Min.   :1549   Min.   :1636  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3399   Max.   :2434   Max.   :2494   Max.   :2404  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       94        16         0        18        19        35         6 
Trial 8 done!
******************
***************
Doing now trial 9 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 664   Min.   :1718   Min.   :1560   Min.   :1678  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3494   Max.   :2361   Max.   :2512   Max.   :2446  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      101        26         0        10        17        44         4 
Trial 9 done!
******************
***************
Doing now trial 10 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 591   Min.   :1739   Min.   :1545   Min.   :1664  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3410   Max.   :2365   Max.   :2541   Max.   :2474  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      102        19         0        16        13        48         6 
Trial 10 done!
******************
***************
Doing now trial 11 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 670   Min.   :1691   Min.   :1588   Min.   :1682  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3427   Max.   :2341   Max.   :2523   Max.   :2441  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      127        25         0        26        15        48        13 
Trial 11 done!
******************
***************
Doing now trial 12 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 730   Min.   :1724   Min.   :1537   Min.   :1679  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3367   Max.   :2365   Max.   :2554   Max.   :2379  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      142        27         0        33        16        56        10 
Trial 12 done!
******************
***************
Doing now trial 13 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 762   Min.   :1726   Min.   :1582   Min.   :1684  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3354   Max.   :2394   Max.   :2545   Max.   :2421  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       99        24         1        23         8        33        10 
Trial 13 done!
******************
***************
Doing now trial 14 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 727   Min.   :1728   Min.   :1565   Min.   :1689  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3382   Max.   :2394   Max.   :2545   Max.   :2438  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      114        25         0        24         8        49         8 
Trial 14 done!
******************
***************
Doing now trial 15 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 716   Min.   :1656   Min.   :1557   Min.   :1714  
 1st Qu.:2006   1st Qu.:1994   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3364   Max.   :2350   Max.   :2506   Max.   :2459  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      161        41         0        31        22        63         4 
Trial 15 done!
******************
***************
Doing now trial 16 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 703   Min.   :1650   Min.   :1508   Min.   :1657  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3387   Max.   :2400   Max.   :2522   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      148        35         0        21        16        68         8 
Trial 16 done!
******************
***************
Doing now trial 17 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 608   Min.   :1723   Min.   :1479   Min.   :1671  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3424   Max.   :2368   Max.   :2577   Max.   :2420  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      123        28         0        13         9        66         7 
Trial 17 done!
******************
***************
Doing now trial 18 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 721   Min.   :1733   Min.   :1525   Min.   :1647  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3383   Max.   :2349   Max.   :2497   Max.   :2446  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      152        40         0        21        14        73         4 
Trial 18 done!
******************
***************
Doing now trial 19 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 650   Min.   :1726   Min.   :1415   Min.   :1629  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3465   Max.   :2359   Max.   :2492   Max.   :2473  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      144        36         1        21        17        59        10 
Trial 19 done!
******************
***************
Doing now trial 20 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 695   Min.   :1703   Min.   :1549   Min.   :1677  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3416   Max.   :2329   Max.   :2582   Max.   :2427  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      115        21         0        23        17        46         8 
Trial 20 done!
******************
***************
Doing now trial 21 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 704   Min.   :1709   Min.   :1596   Min.   :1675  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3398   Max.   :2343   Max.   :2581   Max.   :2430  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      183        43         0        36        16        82         6 
Trial 21 done!
******************
***************
Doing now trial 22 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 699   Min.   :1713   Min.   :1550   Min.   :1653  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3370   Max.   :2364   Max.   :2549   Max.   :2422  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      143        27         1        23        20        59        13 
Trial 22 done!
******************
***************
Doing now trial 23 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 652   Min.   :1675   Min.   :1578   Min.   :1646  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3356   Max.   :2354   Max.   :2531   Max.   :2411  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      150        39         0        27        19        57         8 
Trial 23 done!
******************
***************
Doing now trial 24 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 710   Min.   :1747   Min.   :1609   Min.   :1737  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3413   Max.   :2337   Max.   :2574   Max.   :2424  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       79        17         0        11         7        32        12 
Trial 24 done!
******************
***************
Doing now trial 25 of Trans-2-Hexen-1-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 664   Min.   :1711   Min.   :1545   Min.   :1641  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3418   Max.   :2405   Max.   :2532   Max.   :2477  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      141        34         0        23        13        66         5 
Trial 25 done!
******************
#+end_example

** Diagnostic plots

The counts evolution is:

#+NAME: Trans-2-Hexen-1-ol-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Trans-2-Hexen-1-ol-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Trans_2_Hexen_1_ol_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Trans-2-Hexen-1-ol= for tetrodeD1.
#+RESULTS: Trans-2-Hexen-1-ol-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/Trans-2-Hexen-1-ol-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Trans-2-Hexen-1-ol-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Trans-2-Hexen-1-ol-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Trans_2_Hexen_1_ol_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Trans-2-Hexen-1-ol= for tetrodeD1.
#+RESULTS: Trans-2-Hexen-1-ol-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/Trans-2-Hexen-1-ol-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Trans-2-Hexen-1-ol-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1000 :file Trans-2-Hexen-1-ol-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Trans_2_Hexen_1_ol_tetD1,layout_matrix=matrix(1:12,nr=4,byrow=TRUE))
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Trans-2-Hexen-1-ol.
#+RESULTS: Trans-2-Hexen-1-ol-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/Trans-2-Hexen-1-ol-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Trans-2-Hexen-1-ol
#+BEGIN_SRC R :session *R* :results silent
save(a_Trans_2_Hexen_1_ol_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Trans_2_Hexen_1_ol_tetD1$spike_trains))
    if (!is.null(a_Trans_2_Hexen_1_ol_tetD1$spike_trains[[c_idx]]))
        cat(a_Trans_2_Hexen_1_ol_tetD1$spike_trains[[c_idx]],
            file=paste0("locust20000421_spike_trains/locust20000421_Trans-2-Hexen-1-ol_tetD1_u",
                        c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Hexen-3-ol=

We will carry out an analysis of the 25 trials from =1-Hexen-3-ol=. 
** Do the job

#+NAME: 1-Hexen-3-ol-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Hexen-3-ol"
a_1_Hexen_3_ol_tetD1=smt(stim_name=stim_name,
                         trial_nbs=1:25,
                         centers=a_Trans_2_Hexen_1_ol_tetD1$centers,
                         counts=a_Trans_2_Hexen_1_ol_tetD1$counts)
#+END_SRC

#+RESULTS: 1-Hexen-3-ol-tetD1
#+begin_example
***************
Doing now trial 1 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 771   Min.   :1700   Min.   :1610   Min.   :1622  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3331   Max.   :2373   Max.   :2493   Max.   :2466  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       94        21         1        18        15        33         6 
Trial 1 done!
******************
***************
Doing now trial 2 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 771   Min.   :1726   Min.   :1569   Min.   :1649  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3320   Max.   :2387   Max.   :2503   Max.   :2429  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      131        33         0        16        21        54         7 
Trial 2 done!
******************
***************
Doing now trial 3 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 692   Min.   :1704   Min.   :1576   Min.   :1660  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3295   Max.   :2348   Max.   :2512   Max.   :2393  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        48         1        23        27        56        11 
Trial 3 done!
******************
***************
Doing now trial 4 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 827   Min.   :1761   Min.   :1621   Min.   :1732  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2014   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2087   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2091  
 Max.   :3344   Max.   :2305   Max.   :2466   Max.   :2405  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
       56         6         0        10        18        17         5 
Trial 4 done!
******************
***************
Doing now trial 5 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 757   Min.   :1658   Min.   :1470   Min.   :1648  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3260   Max.   :2364   Max.   :2499   Max.   :2430  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      170        54         1        22        15        67        11 
Trial 5 done!
******************
***************
Doing now trial 6 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 608   Min.   :1651   Min.   :1536   Min.   :1651  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3298   Max.   :2401   Max.   :2520   Max.   :2530  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      132        45         0        18        15        49         5 
Trial 6 done!
******************
***************
Doing now trial 7 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 694   Min.   :1702   Min.   :1579   Min.   :1625  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3271   Max.   :2381   Max.   :2502   Max.   :2447  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      225        74         1        28        25        85        12 
Trial 7 done!
******************
***************
Doing now trial 8 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 725   Min.   :1728   Min.   :1567   Min.   :1630  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3238   Max.   :2378   Max.   :2528   Max.   :2452  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      183        42         0        38        26        67        10 
Trial 8 done!
******************
***************
Doing now trial 9 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 711   Min.   :1721   Min.   :1547   Min.   :1633  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3274   Max.   :2373   Max.   :2515   Max.   :2417  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      189        45         0        39        25        71         9 
Trial 9 done!
******************
***************
Doing now trial 10 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 776   Min.   :1722   Min.   :1545   Min.   :1682  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3292   Max.   :2371   Max.   :2510   Max.   :2458  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      126        29         0        30         9        52         6 
Trial 10 done!
******************
***************
Doing now trial 11 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 687   Min.   :1650   Min.   :1544   Min.   :1659  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3285   Max.   :2368   Max.   :2522   Max.   :2421  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      195        46         1        39        33        68         8 
Trial 11 done!
******************
***************
Doing now trial 12 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 749   Min.   :1714   Min.   :1523   Min.   :1676  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3318   Max.   :2407   Max.   :2537   Max.   :2376  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      123        23         0        30        16        45         9 
Trial 12 done!
******************
***************
Doing now trial 13 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 612   Min.   :1684   Min.   :1540   Min.   :1478  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3316   Max.   :2402   Max.   :2518   Max.   :2438  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      188        53         1        42        29        58         5 
Trial 13 done!
******************
***************
Doing now trial 14 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 665   Min.   :1661   Min.   :1456   Min.   :1684  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3262   Max.   :2369   Max.   :2569   Max.   :2504  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      160        42         0        36        22        53         7 
Trial 14 done!
******************
***************
Doing now trial 15 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 706   Min.   :1653   Min.   :1480   Min.   :1645  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3310   Max.   :2411   Max.   :2561   Max.   :2483  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      162        37         1        48        27        42         7 
Trial 15 done!
******************
***************
Doing now trial 16 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 732   Min.   :1598   Min.   :1499   Min.   :1640  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3315   Max.   :2399   Max.   :2601   Max.   :2441  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      207        71         0        46        20        58        12 
Trial 16 done!
******************
***************
Doing now trial 17 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 733   Min.   :1681   Min.   :1526   Min.   :1650  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3287   Max.   :2364   Max.   :2514   Max.   :2454  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      144        29         0        49        22        41         3 
Trial 17 done!
******************
***************
Doing now trial 18 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 667   Min.   :1689   Min.   :1553   Min.   :1663  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3305   Max.   :2428   Max.   :2565   Max.   :2428  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      187        51         0        52        20        53        11 
Trial 18 done!
******************
***************
Doing now trial 19 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 734   Min.   :1707   Min.   :1534   Min.   :1658  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3325   Max.   :2379   Max.   :2589   Max.   :2442  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      129        32         0        29        16        46         6 
Trial 19 done!
******************
***************
Doing now trial 20 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 788   Min.   :1690   Min.   :1579   Min.   :1639  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3304   Max.   :2340   Max.   :2541   Max.   :2426  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      102        10         0        48        13        28         3 
Trial 20 done!
******************
***************
Doing now trial 21 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 661   Min.   :1671   Min.   :1506   Min.   :1645  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3344   Max.   :2377   Max.   :2587   Max.   :2443  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      141        31         0        46        12        44         8 
Trial 21 done!
******************
***************
Doing now trial 22 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 727   Min.   :1670   Min.   :1499   Min.   :1627  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3353   Max.   :2375   Max.   :2600   Max.   :2446  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      140        32         0        45        13        47         3 
Trial 22 done!
******************
***************
Doing now trial 23 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 757   Min.   :1667   Min.   :1549   Min.   :1649  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3301   Max.   :2414   Max.   :2521   Max.   :2449  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      134        21         0        45        25        42         1 
Trial 23 done!
******************
***************
Doing now trial 24 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 772   Min.   :1685   Min.   :1495   Min.   :1614  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3315   Max.   :2417   Max.   :2597   Max.   :2434  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      135        38         0        32        11        52         2 
Trial 24 done!
******************
***************
Doing now trial 25 of 1-Hexen-3-ol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 749   Min.   :1667   Min.   :1489   Min.   :1621  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3301   Max.   :2392   Max.   :2620   Max.   :2439  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      163        50         1        39        28        41         4 
Trial 25 done!
******************
#+end_example

** Diagnostic plots

The counts evolution is:

#+NAME: 1-Hexen-3-ol-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Hexen-3-ol-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Hexen_3_ol_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Hexen-3-ol= for tetrodeD1.
#+RESULTS: 1-Hexen-3-ol-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Hexen-3-ol-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Hexen-3-ol-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Hexen-3-ol-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Hexen_3_ol_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Hexen-3-ol= for tetrodeD1.
#+RESULTS: 1-Hexen-3-ol-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Hexen-3-ol-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Hexen-3-ol-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Hexen-3-ol-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Hexen_3_ol_tetD1,layout_matrix=matrix(1:12,nr=4,byrow=TRUE))
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Hexen-3-ol.
#+RESULTS: 1-Hexen-3-ol-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/1-Hexen-3-ol-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Hexen-3-ol
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Hexen_3_ol_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Hexen_3_ol_tetD1$spike_trains))
    if (!is.null(a_1_Hexen_3_ol_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Hexen_3_ol_tetD1$spike_trains[[c_idx]],
            file=paste0("locust20000421_spike_trains/locust20000421_1-Hexen-3-ol_tetD1_u",
                        c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =3-Pentanone=

We will carry out an analysis of the 25 trials from =3-Pentanone=. 
** Do the job

#+NAME: 3-Pentanone-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "3-Pentanone"
a_3_Pentanone_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Hexen_3_ol_tetD1$centers,
                        counts=a_1_Hexen_3_ol_tetD1$counts)
#+END_SRC

#+RESULTS: 3-Pentanone-tetD1
#+begin_example
***************
Doing now trial 1 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 842   Min.   :1603   Min.   :1505   Min.   :1634  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3189   Max.   :2431   Max.   :2540   Max.   :2560  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      146        36         3        45        16        42         4 
Trial 1 done!
******************
***************
Doing now trial 2 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 820   Min.   :1672   Min.   :1531   Min.   :1628  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2087   3rd Qu.:2074   3rd Qu.:2090   3rd Qu.:2091  
 Max.   :3224   Max.   :2391   Max.   :2519   Max.   :2441  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      100        28         1        22        14        27         8 
Trial 2 done!
******************
***************
Doing now trial 3 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 842   Min.   :1676   Min.   :1508   Min.   :1625  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3161   Max.   :2367   Max.   :2556   Max.   :2470  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      178        68         4        46        10        42         8 
Trial 3 done!
******************
***************
Doing now trial 4 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 844   Min.   :1703   Min.   :1481   Min.   :1626  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3149   Max.   :2389   Max.   :2580   Max.   :2485  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      168        53         1        52        23        32         7 
Trial 4 done!
******************
***************
Doing now trial 5 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 829   Min.   :1686   Min.   :1512   Min.   :1601  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3174   Max.   :2384   Max.   :2537   Max.   :2454  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      168        56         2        49        18        40         3 
Trial 5 done!
******************
***************
Doing now trial 6 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 791   Min.   :1682   Min.   :1492   Min.   :1647  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2013  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3237   Max.   :2415   Max.   :2613   Max.   :2438  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      151        40         2        41        12        53         3 
Trial 6 done!
******************
***************
Doing now trial 7 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 834   Min.   :1712   Min.   :1547   Min.   :1644  
 1st Qu.:2006   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3196   Max.   :2389   Max.   :2550   Max.   :2425  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      132        28         1        42        14        45         2 
Trial 7 done!
******************
***************
Doing now trial 8 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 867   Min.   :1627   Min.   :1469   Min.   :1643  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3173   Max.   :2443   Max.   :2596   Max.   :2426  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      124        36         0        43        11        30         4 
Trial 8 done!
******************
***************
Doing now trial 9 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 889   Min.   :1675   Min.   :1462   Min.   :1644  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3130   Max.   :2433   Max.   :2581   Max.   :2457  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      170        40         4        56        22        45         3 
Trial 9 done!
******************
***************
Doing now trial 10 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 843   Min.   :1623   Min.   :1482   Min.   :1637  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3174   Max.   :2407   Max.   :2563   Max.   :2546  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      162        43         0        54        16        44         5 
Trial 10 done!
******************
***************
Doing now trial 11 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 850   Min.   :1650   Min.   :1484   Min.   :1646  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3160   Max.   :2421   Max.   :2586   Max.   :2451  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        44         2        48        18        51         3 
Trial 11 done!
******************
***************
Doing now trial 12 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 797   Min.   :1649   Min.   :1449   Min.   :1633  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3204   Max.   :2448   Max.   :2668   Max.   :2470  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      160        34         3        52        16        48         7 
Trial 12 done!
******************
***************
Doing now trial 13 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 859   Min.   :1638   Min.   :1461   Min.   :1623  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3141   Max.   :2446   Max.   :2612   Max.   :2454  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      142        31         1        49        20        36         5 
Trial 13 done!
******************
***************
Doing now trial 14 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 725   Min.   :1643   Min.   :1460   Min.   :1467  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2034   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3170   Max.   :2508   Max.   :2592   Max.   :2506  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      213        55         2        70        17        63         6 
Trial 14 done!
******************
***************
Doing now trial 15 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 769   Min.   :1670   Min.   :1423   Min.   :1602  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3157   Max.   :2439   Max.   :2584   Max.   :2495  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      189        54         0        55        22        54         4 
Trial 15 done!
******************
***************
Doing now trial 16 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 637   Min.   :1625   Min.   :1380   Min.   :1468  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3246   Max.   :2469   Max.   :2686   Max.   :2548  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      151        37         1        50        17        39         7 
Trial 16 done!
******************
***************
Doing now trial 17 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 812   Min.   :1637   Min.   :1450   Min.   :1647  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3157   Max.   :2396   Max.   :2571   Max.   :2467  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      162        49         0        59        20        29         5 
Trial 17 done!
******************
***************
Doing now trial 18 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 841   Min.   :1666   Min.   :1496   Min.   :1563  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3310   Max.   :2469   Max.   :2615   Max.   :2449  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      183        37         0        76        34        33         3 
Trial 18 done!
******************
***************
Doing now trial 19 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 839   Min.   :1678   Min.   :1494   Min.   :1621  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3151   Max.   :2439   Max.   :2568   Max.   :2465  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      188        45         0        74        26        42         1 
Trial 19 done!
******************
***************
Doing now trial 20 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 768   Min.   :1656   Min.   :1451   Min.   :1580  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2012   1st Qu.:2012  
 Median :2048   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3171   Max.   :2483   Max.   :2620   Max.   :2434  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      222        65         1        83        15        54         4 
Trial 20 done!
******************
***************
Doing now trial 21 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 846   Min.   :1627   Min.   :1496   Min.   :1679  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3191   Max.   :2385   Max.   :2547   Max.   :2518  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      188        44         1        56        16        66         5 
Trial 21 done!
******************
***************
Doing now trial 22 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 910   Min.   :1698   Min.   :1446   Min.   :1655  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3261   Max.   :2402   Max.   :2592   Max.   :2412  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      159        30         1        52        20        49         7 
Trial 22 done!
******************
***************
Doing now trial 23 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 850   Min.   :1688   Min.   :1524   Min.   :1644  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3203   Max.   :2390   Max.   :2567   Max.   :2394  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        32         2        59        15        54         4 
Trial 23 done!
******************
***************
Doing now trial 24 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 835   Min.   :1616   Min.   :1442   Min.   :1654  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3125   Max.   :2465   Max.   :2560   Max.   :2449  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        55         1        53        14        42         1 
Trial 24 done!
******************
***************
Doing now trial 25 of 3-Pentanone
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 793   Min.   :1598   Min.   :1451   Min.   :1627  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3182   Max.   :2454   Max.   :2569   Max.   :2431  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      243        57         0        82        15        84         5 
Trial 25 done!
******************
#+end_example


** Diagnostic plots

The counts evolution is:

#+NAME: 3-Pentanone-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 3-Pentanone-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_3_Pentanone_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =3-Pentanone= for tetrodeD1.
#+RESULTS: 3-Pentanone-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/3-Pentanone-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 3-Pentanone-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 3-Pentanone-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_3_Pentanone_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each of the first four units during the 25 trials of =3-Pentanone= for tetrodeD1.
#+RESULTS: 3-Pentanone-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/3-Pentanone-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 3-Pentanone-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1000 :file 3-Pentanone-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_3_Pentanone_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 3-Pentanone.
#+RESULTS: 3-Pentanone-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/3-Pentanone-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-3-Pentanone
#+BEGIN_SRC R :session *R* :results silent
save(a_3_Pentanone_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_3_Pentanone_tetD1$spike_trains))
    if (!is.null(a_3_Pentanone_tetD1$spike_trains[[c_idx]]))
        cat(a_3_Pentanone_tetD1$spike_trains[[c_idx]],
            file=paste0("locust20000421_spike_trains/locust20000421_3-Pentanone_tetD1_u",
                        c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Heptanol=

We will carry out an analysis of the 25 trials from =1-Heptanol=. 
** Do the job

#+NAME: 1-Heptanol-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Heptanol"
a_1_Heptanol_tetD1=smt(stim_name=stim_name,
                       trial_nbs=1:25,
                       centers=a_3_Pentanone_tetD1$centers,
                       counts=a_3_Pentanone_tetD1$counts)
#+END_SRC

#+RESULTS: 1-Heptanol-tetD1
#+begin_example
***************
Doing now trial 1 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 951   Min.   :1684   Min.   :1476   Min.   :1652  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3063   Max.   :2421   Max.   :2569   Max.   :2420  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      137        53         1        37         9        36         1 
Trial 1 done!
******************
***************
Doing now trial 2 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 940   Min.   :1717   Min.   :1548   Min.   :1652  
 1st Qu.:2007   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2087   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3162   Max.   :2382   Max.   :2519   Max.   :2453  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      107        31         2        36        10        27         1 
Trial 2 done!
******************
***************
Doing now trial 3 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 919   Min.   :1702   Min.   :1425   Min.   :1579  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3143   Max.   :2464   Max.   :2637   Max.   :2474  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      152        37         0        61        15        34         5 
Trial 3 done!
******************
***************
Doing now trial 4 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 917   Min.   :1725   Min.   :1511   Min.   :1569  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3141   Max.   :2375   Max.   :2600   Max.   :2430  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      138        44         1        50        13        25         5 
Trial 4 done!
******************
***************
Doing now trial 5 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 876   Min.   :1680   Min.   :1483   Min.   :1640  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3096   Max.   :2469   Max.   :2547   Max.   :2424  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      159        67         0        60        13        16         3 
Trial 5 done!
******************
***************
Doing now trial 6 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 844   Min.   :1707   Min.   :1493   Min.   :1663  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3118   Max.   :2380   Max.   :2537   Max.   :2456  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      135        27         1        65        10        29         3 
Trial 6 done!
******************
***************
Doing now trial 7 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 934   Min.   :1694   Min.   :1486   Min.   :1675  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2074   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3083   Max.   :2367   Max.   :2529   Max.   :2425  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      174        61         3        57        13        35         5 
Trial 7 done!
******************
***************
Doing now trial 8 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 927   Min.   :1695   Min.   :1447   Min.   :1660  
 1st Qu.:2006   1st Qu.:1996   1st Qu.:2013   1st Qu.:2012  
 Median :2046   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2074   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3082   Max.   :2344   Max.   :2535   Max.   :2432  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      106        19         0        53        14        17         3 
Trial 8 done!
******************
***************
Doing now trial 9 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 899   Min.   :1690   Min.   :1508   Min.   :1648  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3097   Max.   :2385   Max.   :2547   Max.   :2502  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      163        68         1        42        14        34         4 
Trial 9 done!
******************
***************
Doing now trial 10 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 925   Min.   :1675   Min.   :1483   Min.   :1601  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3073   Max.   :2378   Max.   :2548   Max.   :2453  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      204        51         3        84        23        41         2 
Trial 10 done!
******************
***************
Doing now trial 11 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 853   Min.   :1709   Min.   :1492   Min.   :1611  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3155   Max.   :2387   Max.   :2587   Max.   :2434  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      214        55         4        92        14        42         7 
Trial 11 done!
******************
***************
Doing now trial 12 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 866   Min.   :1685   Min.   :1510   Min.   :1615  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2046   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3146   Max.   :2463   Max.   :2535   Max.   :2401  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      175        35         5        73        15        46         1 
Trial 12 done!
******************
***************
Doing now trial 13 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 802   Min.   :1710   Min.   :1515   Min.   :1471  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3074   Max.   :2538   Max.   :2531   Max.   :2472  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      196        56         2        59         7        69         3 
Trial 13 done!
******************
***************
Doing now trial 14 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 797   Min.   :1704   Min.   :1482   Min.   :1551  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3065   Max.   :2380   Max.   :2542   Max.   :2385  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      184        42         5        71        16        46         4 
Trial 14 done!
******************
***************
Doing now trial 15 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 870   Min.   :1677   Min.   :1545   Min.   :1632  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3121   Max.   :2394   Max.   :2523   Max.   :2419  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      137        21         1        60        14        39         2 
Trial 15 done!
******************
***************
Doing now trial 16 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 938   Min.   :1646   Min.   :1489   Min.   :1657  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3072   Max.   :2407   Max.   :2551   Max.   :2415  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      166        42         1        75        12        34         2 
Trial 16 done!
******************
***************
Doing now trial 17 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 913   Min.   :1714   Min.   :1559   Min.   :1628  
 1st Qu.:2007   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3076   Max.   :2367   Max.   :2555   Max.   :2432  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      133        17         1        62         8        42         3 
Trial 17 done!
******************
***************
Doing now trial 18 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 849   Min.   :1703   Min.   :1555   Min.   :1657  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2047   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3073   Max.   :2392   Max.   :2525   Max.   :2409  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      196        39         4        70        14        64         5 
Trial 18 done!
******************
***************
Doing now trial 19 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 919   Min.   :1719   Min.   :1546   Min.   :1642  
 1st Qu.:2006   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2052  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2088   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3187   Max.   :2375   Max.   :2531   Max.   :2407  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      121        14         1        44         6        53         3 
Trial 19 done!
******************
***************
Doing now trial 20 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 910   Min.   :1718   Min.   :1524   Min.   :1664  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3192   Max.   :2344   Max.   :2536   Max.   :2394  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      121        29         1        46         8        37         0 
Trial 20 done!
******************
***************
Doing now trial 21 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 920   Min.   :1743   Min.   :1556   Min.   :1667  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3149   Max.   :2341   Max.   :2545   Max.   :2404  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      128        11         1        68        13        31         4 
Trial 21 done!
******************
***************
Doing now trial 22 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 864   Min.   :1667   Min.   :1520   Min.   :1632  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2076   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3111   Max.   :2360   Max.   :2519   Max.   :2416  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      133        33         2        59         9        27         3 
Trial 22 done!
******************
***************
Doing now trial 23 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 971   Min.   :1735   Min.   :1547   Min.   :1663  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2012   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2090   3rd Qu.:2075   3rd Qu.:2092   3rd Qu.:2092  
 Max.   :3116   Max.   :2409   Max.   :2499   Max.   :2408  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      144        21         1        59         8        53         2 
Trial 23 done!
******************
***************
Doing now trial 24 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 955   Min.   :1701   Min.   :1535   Min.   :1619  
 1st Qu.:2005   1st Qu.:1994   1st Qu.:2012   1st Qu.:2011  
 Median :2047   Median :2035   Median :2053   Median :2053  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2091   3rd Qu.:2076   3rd Qu.:2092   3rd Qu.:2093  
 Max.   :3076   Max.   :2348   Max.   :2525   Max.   :2403  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      183        51         5        54        11        61         1 
Trial 24 done!
******************
***************
Doing now trial 25 of 1-Heptanol
The five number summary is:
      ch09           ch10           ch11           ch12     
 Min.   : 867   Min.   :1647   Min.   :1547   Min.   :1650  
 1st Qu.:2005   1st Qu.:1995   1st Qu.:2013   1st Qu.:2012  
 Median :2047   Median :2035   Median :2053   Median :2052  
 Mean   :2046   Mean   :2035   Mean   :2052   Mean   :2052  
 3rd Qu.:2089   3rd Qu.:2075   3rd Qu.:2091   3rd Qu.:2092  
 Max.   :3105   Max.   :2350   Max.   :2515   Max.   :2358  

Global counts at classification's end:
    Total Cluster 1 Cluster 2 Cluster 3 Cluster 4 Cluster 5         ? 
      106        21         0        37         7        36         5 
Trial 25 done!
******************
#+end_example

** Diagnostic plots

The counts evolution is:

#+NAME: 1-Heptanol-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Heptanol-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Heptanol_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Heptanol= for tetrodeD1.
#+RESULTS: 1-Heptanol-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Heptanol-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Heptanol-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Heptanol-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Heptanol_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each of the first four units during the 25 trials of =1-Heptanol= for tetrodeD1.
#+RESULTS: 1-Heptanol-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Heptanol-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Heptanol-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Heptanol-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
cp_isi_raster(a_1_Heptanol_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Heptanol.
#+RESULTS: 1-Heptanol-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/1-Heptanol-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Heptanol
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Heptanol_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Heptanol_tetD1$spike_trains))
    if (!is.null(a_1_Heptanol_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Heptanol_tetD1$spike_trains[[c_idx]],
            file=paste0("locust20000421_spike_trains/locust20000421_1-Heptanol_tetD1_u",
                        c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-0) first=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-0) first=. 
** Do the job

#+NAME: 1-Octanol (10^-0) first-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-0) first"
a_1_Octanol_0_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Heptanol_tetD1$centers,
                        counts=a_1_Heptanol_tetD1$counts)

#+END_SRC

** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-0) first-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-0) first-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_0_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-0) first= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-0) first-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Octanol (10^-0) first-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-0) first-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-0) first-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_0_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each of the first four units during the 25 trials of =1-Octanol (10^-0) first= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-0) first-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/1-Octanol (10^-0) first-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-0) first-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-0) first-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_0_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-0) first.
#+RESULTS: 1-Octanol (10^-0) first-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/1-Octanol (10^-0) first-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-0) first
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_0_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_0_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_0_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_0_tetD1$spike_trains[[c_idx]],
            file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-0) first_tetD1_u",
                        c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =2-Heptanone=

We will carry out an analysis of the 25 trials from =2-Heptanone=. 
** Do the job

#+NAME: 2-Heptanone-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "2-Heptanone"
a_2_Heptanone_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Octanol_0_tetD1$centers,
                        counts=a_1_Octanol_0_tetD1$counts)
#+END_SRC

** Diagnostic plots

The counts evolution is:

#+NAME: 2-Heptanone-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 2-Heptanone-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_2_Heptanone_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =2-Heptanone= for tetrodeD1.
#+RESULTS: 2-Heptanone-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/2-Heptanone-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 2-Heptanone-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 2-Heptanone-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_2_Heptanone_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =2-Heptanone= for tetrodeD1.
#+RESULTS: 2-Heptanone-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/2-Heptanone-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 2-Heptanone-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 2-Heptanone-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_2_Heptanone_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 2-Heptanone.
#+RESULTS: 2-Heptanone-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/2-Heptanone-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-2-Heptanone
#+BEGIN_SRC R :session *R* :results silent
save(a_2_Heptanone_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_2_Heptanone_tetD1$spike_trains))
    if (!is.null(a_2_Heptanone_tetD1$spike_trains[[c_idx]]))
        cat(a_2_Heptanone_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_2-Heptanone_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =3-Heptanone=

We will carry out an analysis of the 25 trials from =3-Heptanone=.  

** Do the job

#+NAME: 3-Heptanone-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "3-Heptanone"
a_3_Heptanone_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_2_Heptanone_tetD1$centers,
                        counts=a_2_Heptanone_tetD1$counts)
#+END_SRC

** Diagnostic plots

The counts evolution is:

#+NAME: 3-Heptanone-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 3-Heptanone-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_3_Heptanone_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =3-Heptanone= for tetrodeD1.
#+RESULTS: 3-Heptanone-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/3-Heptanone-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 3-Heptanone-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 3-Heptanone-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_3_Heptanone_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =3-Heptanone= for tetrodeD1.
#+RESULTS: 3-Heptanone-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/3-Heptanone-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 3-Heptanone-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 3-Heptanone-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_3_Heptanone_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 3-Heptanone.
#+RESULTS: 3-Heptanone-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/3-Heptanone-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-3-Heptanone
#+BEGIN_SRC R :session *R* :results silent
save(a_3_Heptanone_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_3_Heptanone_tetD1$spike_trains))
    if (!is.null(a_3_Heptanone_tetD1$spike_trains[[c_idx]]))
        cat(a_3_Heptanone_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_3-Heptanone_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Citral=

We will carry out an analysis of the 25 trials from =Citral=. 
** Do the job

#+NAME: Citral-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Citral"
a_Citral_tetD1=smt(stim_name=stim_name,
                   trial_nbs=1:25,
                   centers=a_3_Heptanone_tetD1$centers,
                   counts=a_3_Heptanone_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Citral-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Citral-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Citral_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Citral= for tetrodeD1.
#+RESULTS: Citral-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/Citral-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Citral-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Citral-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Citral_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Citral= for tetrodeD1.
#+RESULTS: Citral-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/Citral-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Citral-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Citral-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Citral_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Citral.
#+RESULTS: Citral-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/Citral-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Citral
#+BEGIN_SRC R :session *R* :results silent
save(a_Citral_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Citral_tetD1$spike_trains))
    if (!is.null(a_Citral_tetD1$spike_trains[[c_idx]]))
        cat(a_Citral_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Citral_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Apple=

We will carry out an analysis of the 25 trials from =Apple=. 
** Do the job

#+NAME: Apple-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Apple"
a_Apple_tetD1=smt(stim_name=stim_name,
                  trial_nbs=1:25,
                  centers=a_Citral_tetD1$centers,
                  counts=a_Citral_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Apple-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Apple-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Apple_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Apple= for tetrodeD1.
#+RESULTS: Apple-count-evolution-tetD1
[[file:locust20000421_tetD1_fig/Apple-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Apple-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Apple-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports both :results output graphics :session *R*
waveform_evolution(a_Apple_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Apple= for tetrodeD1.
#+RESULTS: Apple-waveform-evolution-tetD1
[[file:locust20000421_tetD1_fig/Apple-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Apple-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Apple-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Apple_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Apple.
#+RESULTS: Apple-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1_fig/Apple-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Apple
#+BEGIN_SRC R :session *R* :results silent
save(a_Apple_tetD1s,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Apple_tetD1$spike_trains))
    if (!is.null(a_Apple_tetD1$spike_trains[[c_idx]]))
        cat(a_Apple_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Apple_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Mint=

We will carry out an analysis of the 25 trials from =Mint=. 
** Do the job

#+NAME: Mint-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Mint"
a_Mint_tetD1=smt(stim_name=stim_name,
                 trial_nbs=1:25,
                 centers=a_Apple_tetD1$centers,
                 counts=a_Apple_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Mint-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Mint-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Mint_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Mint= for tetrodeD1.
#+RESULTS: Mint-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Mint-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Mint-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Mint-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Mint_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Mint= for tetrodeD1.
#+RESULTS: Mint-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Mint-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Mint-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Mint-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Mint_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Mint.
#+RESULTS: Mint-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/Mint-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Mint
#+BEGIN_SRC R :session *R* :results silent
save(a_Mint_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Mint_sterC$spike_trains))
    if (!is.null(a_Mint_sterC$spike_trains[[c_idx]]))
        cat(a_Mint_sterC$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Mint_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Strawberry=

We will carry out an analysis of the 25 trials from =Strawberry=.  

** Do the job

#+NAME: Strawberry-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Strawberry"
a_Strawberry_tetD1=smt(stim_name=stim_name,
                       trial_nbs=1:25,
                       centers=a_Mint_tetD1$centers,
                       counts=a_Mint_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Strawberry-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Strawberry-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Strawberry_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Strawberry= for tetrodeD1.
#+RESULTS: Strawberry-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Strawberry-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Strawberry-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Strawberry-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Strawberry_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Strawberry= for tetrodeD1.
#+RESULTS: Strawberry-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Strawberry-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Strawberry-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Strawberry-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Strawberry_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Strawberry.
#+RESULTS: Strawberry-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/Strawberry-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Strawberry
#+BEGIN_SRC R :session *R* :results silent
save(a_Strawberry_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Strawberry_sterC$spike_trains))
    if (!is.null(a_Strawberry_sterC$spike_trains[[c_idx]]))
        cat(a_Strawberry_sterC$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Strawberry_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Amyl Acetate=

We will carry out an analysis of the 25 trials from =Amyl Acetate=. 

** Do the job

#+NAME: Amyl Acetate-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Amyl Acetate"
a_Amyl_Acetate_tetD1=smt(stim_name=stim_name,
                         trial_nbs=1:25,
                         centers=a_Strawberry_tetD1$centers,
                         counts=a_Strawberry_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Amyl Acetate-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Amyl Acetate-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Amyl_Acetate_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Amyl Acetate= for tetrodeD1.
#+RESULTS: Amyl Acetate-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Amyl Acetate-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Amyl Acetate-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Amyl Acetate-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Amyl_Acetate_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Amyl Acetate= for tetrodeD1.
#+RESULTS: Amyl Acetate-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Amyl Acetate-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Amyl Acetate-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Amyl Acetate-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Amyl_Acetate_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Amyl Acetate.
#+RESULTS: Amyl Acetate-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/Amyl Acetate-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Amyl Acetate
#+BEGIN_SRC R :session *R* :results silent
save(a_Amyl_Acetate_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Amyl_Acetate_tetD1$spike_trains))
    if (!is.null(a_Amyl_Acetate_tetD1$spike_trains[[c_idx]]))
        cat(a_Amyl_Acetate_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Amyl Acetate_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =Octaldehyde=

We will carry out an analysis of the 25 trials from =Octaldehyde=. 
** Do the job

#+NAME: Octaldehyde-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "Octaldehyde"
a_Octaldehyde_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_Amyl_Acetate_tetD1$centers,
                        counts=a_Amyl_Acetate_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: Octaldehyde-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file Octaldehyde-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_Octaldehyde_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =Octaldehyde= for tetrodeD1.
#+RESULTS: Octaldehyde-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Octaldehyde-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: Octaldehyde-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file Octaldehyde-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_Octaldehyde_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =Octaldehyde= for tetrodeD1.
#+RESULTS: Octaldehyde-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/Octaldehyde-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: Octaldehyde-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file Octaldehyde-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_Octaldehyde_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for Octaldehyde.
#+RESULTS: Octaldehyde-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/Octaldehyde-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-Octaldehyde
#+BEGIN_SRC R :session *R* :results silent
save(a_Octaldehyde_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_Octaldehyde_tetD1$spike_trains))
    if (!is.null(a_Octaldehyde_tetD1$spike_trains[[c_idx]]))
        cat(a_Octaldehyde_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_Octaldehyde_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-5)=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-5)=.  

** Do the job

#+NAME: 1-Octanol (10^-5)-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-5)"
a_1_Octanol_5_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_Octaldehyde_tetD1$centers,
                        counts=a_Octaldehyde_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-5)-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-5)-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_5_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-5)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-5)-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-5)-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-5)-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-5)-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_5_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-5)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-5)-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-5)-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-5)-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-5)-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_5_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-5).
#+RESULTS: 1-Octanol (10^-5)-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-5)-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-5)
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_5_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_5_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_5_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_5_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-5)_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-4)=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-4)=. 
** Do the job

#+NAME: 1-Octanol (10^-4)-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-4)"
a_1_Octanol_4_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Octanol_5_tetD1$centers,
                        counts=a_1_Octanol_5_tetD1$counts)
#+END_SRC



** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-4)-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-4)-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_4_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-4)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-4)-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-4)-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-4)-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-4)-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_4_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-4)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-4)-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-4)-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-4)-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-4)-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_4_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-4).
#+RESULTS: 1-Octanol (10^-4)-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-4)-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-4)
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_4_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_4_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_4_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_4_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-4)_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-3)=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-3)=. 
** Do the job

#+NAME: 1-Octanol (10^-3)-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-3)"
a_1_Octanol_3_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Octanol_4_tetD1$centers,
                        counts=a_1_Octanol_4_tetD1$counts)
#+END_SRC

** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-3)-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-3)-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_3_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-3)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-3)-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-3)-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-3)-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-3)-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_3_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-3)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-3)-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-3)-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-3)-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-3)-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_3_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-3).
#+RESULTS: 1-Octanol (10^-3)-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-3)-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-3)
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_3_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_3_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_3_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_3_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-3)_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-2)=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-2)=.  

** Do the job

#+NAME: 1-Octanol (10^-2)-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-2)"
a_1_Octanol_2_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Octanol_3_tetD1$centers,
                        counts=a_1_Octanol_3_tetD1$counts)
#+END_SRC

** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-2)-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-2)-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_2_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-2)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-2)-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-2)-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-2)-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-2)-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_2_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-2)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-2)-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-2)-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-2)-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-2)-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_2_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-2).
#+RESULTS: 1-Octanol (10^-2)-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-2)-CP-and-ISI-dist-tetD1.png]]

** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-2)
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_2_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_2_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_2_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_2_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-2)_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-1)=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-1)=. 
** Do the job

#+NAME: 1-Octanol (10^-1)-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-1)"
a_1_Octanol_1_tetD1=smt(stim_name=stim_name,
                        trial_nbs=1:25,
                        centers=a_1_Octanol_2_tetD1$centers,
                        counts=a_1_Octanol_2_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-1)-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-1)-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_1_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-1)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-1)-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-1)-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-1)-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-1)-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_1_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-1)= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-1)-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-1)-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-1)-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-1)-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_1_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-1).
#+RESULTS: 1-Octanol (10^-1)-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-1)-CP-and-ISI-dist-tetD1.png]]


** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-1)
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_1_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_1_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_1_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_1_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-1)_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC

* 25 trials with =1-Octanol (10^-0) second=

We will carry out an analysis of the 25 trials from =1-Octanol (10^-0) second=. 
** Do the job

#+NAME: 1-Octanol (10^-0) second-tetD1
#+BEGIN_SRC R :exports code :results output :session *R*
stim_name = "1-Octanol (10^-0) second"
a_1_Octanol_0b_tetD1=smt(stim_name=stim_name,
                         trial_nbs=1:25,
                         centers=a_1_Octanol_1_tetD1$centers,
                         counts=a_1_Octanol_1_tetD1$counts)
#+END_SRC


** Diagnostic plots

The counts evolution is:

#+NAME: 1-Octanol (10^-0) second-count-evolution-tetD1
#+HEADER: :width 800 :height 800 :file 1-Octanol (10^-0) second-count-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
counts_evolution(a_1_Octanol_0b_tetD1)
#+END_SRC

#+CAPTION: Evolution of the number of events attributed to each unit (1 to 5) or unclassified ("?") during the 25 trials of =1-Octanol (10^-0) second= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-0) second-count-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-0) second-count-evolution-tetD1.png]]

The waveform evolution is:

#+NAME: 1-Octanol (10^-0) second-waveform-evolution-tetD1
#+HEADER: :width 800 :height 1000 :file 1-Octanol (10^-0) second-waveform-evolution-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
waveform_evolution(a_1_Octanol_0b_tetD1,threshold_factor)
#+END_SRC

#+CAPTION: Evolution of the templates of each unit during the 25 trials of =1-Octanol (10^-0) second= for tetrodeD1.
#+RESULTS: 1-Octanol (10^-0) second-waveform-evolution-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-0) second-waveform-evolution-tetD1.png]]

The observed counting processes, inter spike intervals densities and raster plots are:

#+NAME: 1-Octanol (10^-0) second-CP-and-ISI-dist-tetD1
#+HEADER: :width 800 :height 1200 :file 1-Octanol (10^-0) second-CP-and-ISI-dist-tetD1.png
#+BEGIN_SRC R :exports results :results output graphics :session *R*
cp_isi_raster(a_1_Octanol_0b_tetD1)
#+END_SRC

#+CAPTION: Observed counting processes, empirical inter spike interval distributions and raster plots for 1-Octanol (10^-0) second.
#+RESULTS: 1-Octanol (10^-0) second-CP-and-ISI-dist-tetD1
[[file:locust20000421_tetD1a_fig/1-Octanol (10^-0) second-CP-and-ISI-dist-tetD1.png]]


** Save results

Before analyzing the next set of trials we save the output of =sort_many_trials= to disk with:

#+NAME: save-counts-and-centers-to-disk-1-Octanol (10^-0) second
#+BEGIN_SRC R :session *R* :results silent
save(a_1_Octanol_0b_tetD1,
     file=paste0("tetD1_analysis/tetD1_",stim_name,"_summary_obj.rda"))
#+END_SRC

We write to disk the spike trains in text mode:

#+NAME: write-spike-trains-tetD1
#+BEGIN_SRC R :session *R* :results silent
for (c_idx in 1:length(a_1_Octanol_0b_tetD1$spike_trains))
    if (!is.null(a_1_Octanol_0b_tetD1$spike_trains[[c_idx]]))
        cat(a_1_Octanol_0b_tetD1$spike_trains[[c_idx]],file=paste0("locust20000421_spike_trains/locust20000421_1-Octanol (10^-0) second_tetD1_u",c_idx,".txt"),sep="\n")
#+END_SRC



